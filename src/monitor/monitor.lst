
Portable 65xx Assembler [20.01]

                             ;===============================================================================
                             ; __        ____  ____   ____ ___ ____  ______  ______
                             ; \ \      / / /_| ___| / ___/ _ \___ \/ ___\ \/ / __ )
                             ;  \ \ /\ / / '_ \___ \| |  | | | |__) \___ \\  /|  _ \
                             ;   \ V  V /| (_) |__) | |__| |_| / __/ ___) /  \| |_) |
                             ;  __\_/\_/  \___/____/ \____\___/_____|____/_/\_\____/
                             ; |  \/  | ___  _ __ (_) |_ ___  _ __
                             ; | |\/| |/ _ \| '_ \| | __/ _ \| '__|
                             ; | |  | | (_) | | | | | || (_) | |
                             ; |_|  |_|\___/|_| |_|_|\__\___/|_|
                             ;
                             ;
                             ;-------------------------------------------------------------------------------
                             ; Copyright (C)2014-2020 Andrew John Jacobs.
                             ; All rights reserved.
                             ;
                             ; This work is made available under the terms of the Creative Commons
                             ; Attribution-NonCommercial-ShareAlike 4.0 International license. Open the
                             ; following URL to see the details.
                             ;
                             ; http://creativecommons.org/licenses/by-nc-sa/4.0/
                             ;===============================================================================
                             ;
                             ; Notes:
                             ;
                             ;
                             ;-------------------------------------------------------------------------------

                                             .include "w65c02sxb.inc"
                             ;===============================================================================
                             ; __        ____  ____   ____ ___ ____  ______  ______
                             ; \ \      / / /_| ___| / ___/ _ \___ \/ ___\ \/ / __ )
                             ;  \ \ /\ / / '_ \___ \| |  | | | |__) \___ \\  /|  _ \
                             ;   \ V  V /| (_) |__) | |__| |_| / __/ ___) /  \| |_) |
                             ;    \_/\_/  \___/____/ \____\___/_____|____/_/\_\____/
                             ;
                             ; WDC W65C02SXB System Definitions
                             ;-------------------------------------------------------------------------------
                             ; Copyright (C)2020 Andrew Jacobs.
                             ; All rights reserved.
                             ;
                             ; This work is made available under the terms of the Creative Commons
                             ; Attribution-ShareAlike 4.0 International license. Open the following URL to
                             ; see the details.
                             ;
                             ; https://creativecommons.org/licenses/by-sa/4.0/
                             ;
                             ;===============================================================================
                             ; Notes:
                             ;
                             ;-------------------------------------------------------------------------------

                                             .include "w65c02.inc"
                             ;===============================================================================

Portable 65xx Assembler [20.01]

                             ; WDC W65C02 Processor Definitions
                             ;-------------------------------------------------------------------------------
                             ; Copyright (C)2020 Andrew Jacobs.
                             ; All rights reserved.
                             ;
                             ; This work is made available under the terms of the Creative Commons
                             ; Attribution-ShareAlike 4.0 International license. Open the following URL to
                             ; see the details.
                             ;
                             ; https://creativecommons.org/licenses/by-sa/4.0/
                             ;
                             ;===============================================================================
                             ; Notes:
                             ;
                             ;-------------------------------------------------------------------------------

                                             .65c02

                             ;===============================================================================
                             ; Constants
                             ;-------------------------------------------------------------------------------

                             ; Status Registers Bits

         00000080          = N               .equ    $80
         00000040          = V               .equ    $40
         00000010          = B               .equ    $10
         00000008          = D               .equ    $08
         00000004          = I               .equ    $04
         00000002          = Z               .equ    $02
         00000001          = C               .equ    $01

                             ; Hardware Stack Page

         00000100          = STACK           .equ    $0100
                                             .include "w65c21.inc"
                             ;===============================================================================
                             ; __        ____  ____   ____ ____  _
                             ; \ \      / / /_| ___| / ___|___ \/ |
                             ;  \ \ /\ / / '_ \___ \| |     __) | |
                             ;   \ V  V /| (_) |__) | |___ / __/| |
                             ;    \_/\_/  \___/____/ \____|_____|_|
                             ;
                             ; WDC W65C21 Peripheral Interface Adapter (PIA) Definitions
                             ;-------------------------------------------------------------------------------
                             ; Copyright (C)2020 Andrew Jacobs.
                             ; All rights reserved.
                             ;
                             ; This work is made available under the terms of the Creative Commons
                             ; Attribution-ShareAlike 4.0 International license. Open the following URL to
                             ; see the details.
                             ;
                             ; https://creativecommons.org/licenses/by-sa/4.0/
                             ;

Portable 65xx Assembler [20.01]

                             ;===============================================================================
                             ; Notes:
                             ;
                             ;-------------------------------------------------------------------------------

                             ;===============================================================================
                             ; Peripheral Registers
                             ;-------------------------------------------------------------------------------

         00000000          = PIA_ORA         .equ    0               ; When CRA.DDRA = 1
         00000000          = PIA_DDRA        .equ    0               ; When CRA.DDRA = 0
         00000001          = PIA_CRA         .equ    1
         00000002          = PIA_ORB         .equ    2               ; When CRB.DDRB = 1
         00000002          = PIA_DDRB        .equ    2               ; When CRB.DDRB = 0
         00000003          = PIA_CRB         .equ    3

                             ; CRA Register Bits

         00000080          = PIA_CRA_IRQA1   .equ    $80
         00000040          = PIA_CRA_IRQA2   .equ    $40
         00000020          = PIA_CRA_CA22    .equ    $20
         00000010          = PIA_CRA_CA21    .equ    $10
         00000008          = PIA_CRA_CA20    .equ    $08
         00000004          = PIA_CRA_DDRA    .equ    $04
         00000002          = PIA_CRA_CA11    .equ    $02
         00000001          = PIA_CRA_CA10    .equ    $01

                             ; CRB Register Bits

         00000080          = PIA_CRB_IRQB1   .equ    $80
         00000040          = PIA_CRB_IRQB2   .equ    $40
         00000020          = PIA_CRB_CB22    .equ    $20
         00000010          = PIA_CRB_CB21    .equ    $10
         00000008          = PIA_CRB_CB20    .equ    $08
         00000004          = PIA_CRB_DDRB    .equ    $04
         00000002          = PIA_CRB_CB11    .equ    $02
         00000001          = PIA_CRB_CB10    .equ    $01
                                             .include "w65c22.inc"
                             ;===============================================================================
                             ; __        ____  ____   ____ ____  ____
                             ; \ \      / / /_| ___| / ___|___ \|___ \
                             ;  \ \ /\ / / '_ \___ \| |     __) | __) |
                             ;   \ V  V /| (_) |__) | |___ / __/ / __/
                             ;    \_/\_/  \___/____/ \____|_____|_____|
                             ;
                             ; WDC W65C22 Versatile Interface Adapter (VIA) Definitions
                             ;-------------------------------------------------------------------------------
                             ; Copyright (C)2020 Andrew Jacobs.
                             ; All rights reserved.
                             ;
                             ; This work is made available under the terms of the Creative Commons
                             ; Attribution-ShareAlike 4.0 International license. Open the following URL to
                             ; see the details.
                             ;

Portable 65xx Assembler [20.01]

                             ; https://creativecommons.org/licenses/by-sa/4.0/
                             ;
                             ;===============================================================================
                             ; Notes:
                             ;
                             ;-------------------------------------------------------------------------------

                             ;===============================================================================
                             ; Peripheral Registers
                             ;-------------------------------------------------------------------------------

         00000000          = VIA_ORB         .equ    $00
         00000000          = VIA_IRB         .equ    $00
         00000001          = VIA_ORA         .equ    $01
         00000001          = VIA_IRA         .equ    $01
         00000002          = VIA_DDRB        .equ    $02
         00000003          = VIA_DDRA        .equ    $03
         00000004          = VIA_T1CL        .equ    $04
         00000005          = VIA_T1CH        .equ    $05
         00000006          = VIA_T1LL        .equ    $06
         00000007          = VIA_T1LH        .equ    $07
         00000008          = VIA_T2CL        .equ    $08
         00000009          = VIA_T2CH        .equ    $09
         0000000A          = VIA_SR          .equ    $0a
         0000000B          = VIA_ACR         .equ    $0b
         0000000C          = VIA_PCR         .equ    $0c
         0000000D          = VIA_IFR         .equ    $0d
         0000000E          = VIA_IER         .equ    $0e
         0000000F          = VIA_ORAN        .equ    $0f
         0000000F          = VIA_IRAN        .equ    $0f

                             ; ACR Register Bits

         00000080          = VIA_ACR_T1C1    .equ    $80
         00000040          = VIA_ACR_T1C0    .equ    $40
         00000020          = VIA_ACR_T2C     .equ    $20
         00000010          = VIA_ACR_SRC2    .equ    $10
         00000008          = VIA_ACR_SRC1    .equ    $08
         00000004          = VIA_ACR_SRC0    .equ    $04
         00000002          = VIA_ACR_PA      .equ    $02
         00000001          = VIA_ACR_PB      .equ    $01

                             ; PCR Register Bits

         00000080          = VIA_PCR_CB2C2   .equ    $80
         00000040          = VIA_PCR_CB2C1   .equ    $40
         00000020          = VIA_PCR_CB2C0   .equ    $20
         00000010          = VIA_PCR_CB1C    .equ    $10
         00000008          = VIA_PCR_CA2C2   .equ    $08
         00000004          = VIA_PCR_CA2C1   .equ    $04
         00000002          = VIA_PCR_CA2C0   .equ    $02
         00000001          = VIA_PCR_CA1C    .equ    $01

                             ; IFR Register Bits

Portable 65xx Assembler [20.01]


         00000080          = VIA_IFR_IRQ     .equ    $80
         00000040          = VIA_IFR_T1      .equ    $40
         00000020          = VIA_IFR_T2      .equ    $20
         00000010          = VIA_IFR_CB1     .equ    $10
         00000008          = VIA_IFR_CB2     .equ    $08
         00000004          = VIA_IFR_SR      .equ    $04
         00000002          = VIA_IFR_CA1     .equ    $02
         00000001          = VIA_IFR_CA2     .equ    $01

                             ; IER Register Bits

         00000080          = VIA_IER_SET     .equ    $80
         00000040          = VIA_IER_T1      .equ    $40
         00000020          = VIA_IER_T2      .equ    $20
         00000010          = VIA_IER_CB1     .equ    $10
         00000008          = VIA_IER_CB2     .equ    $08
         00000004          = VIA_IER_SR      .equ    $04
         00000002          = VIA_IER_CA1     .equ    $02
         00000001          = VIA_IER_CA2     .equ    $01
                                             .include "w65c51.inc"
                             ;===============================================================================
                             ; WDC W65C51 Asynchronous Communications Interface Adapter (ACIA) Definitions
                             ;-------------------------------------------------------------------------------
                             ; Copyright (C)2020 Andrew Jacobs.
                             ; All rights reserved.
                             ;
                             ; This work is made available under the terms of the Creative Commons
                             ; Attribution-ShareAlike 4.0 International license. Open the following URL to
                             ; see the details.
                             ;
                             ; https://creativecommons.org/licenses/by-sa/4.0/
                             ;
                             ;===============================================================================
                             ; Notes:
                             ;
                             ; The 'Transmitter Data Register Empty' (TDRE) bit in the status register is
                             ; faulty in physical W65C51 chips.
                             ;-------------------------------------------------------------------------------

                             ;===============================================================================
                             ; Peripheral Registers
                             ;-------------------------------------------------------------------------------

         00000000          = ACIA_DATA       .equ    0               ; Transmit/Receive Register
         00000001          = ACIA_SR         .equ    1               ; Status Register
         00000002          = ACIA_CMD        .equ    2               ; Command Register
         00000003          = ACIA_CR         .equ    3               ; Control Register

         00000080          = ACIA_SR_IRQ     .equ    1<<7            ; Interrupt (IRQ)
         00000040          = ACIA_SR_DSRB    .equ    1<<6            ; Data Set Ready (0=Ready)
         00000020          = ACIA_SR_DCDB    .equ    1<<5            ; Data Carrier Detect (0=Detected)
         00000010          = ACIA_SR_TDRE    .equ    1<<4            ; Tranmitter Data Register Empty
         00000008          = ACIA_SR_RDRF    .equ    1<<3            ; Receiver Data Register Full

Portable 65xx Assembler [20.01]

         00000004          = ACIA_SR_OVRN    .equ    1<<2            ; Overrun
         00000002          = ACIA_SR_FE      .equ    1<<1            ; Framing Error
         00000001          = ACIA_SR_PE      .equ    1<<0            ; Parity Error

         00000080          = ACIA_CMD_PMC1   .equ    1<<7
         00000040          = ACIA_CMD_PMC0   .equ    1<<6
         00000020          = ACIA_CMD_PME    .equ    1<<5
         00000010          = ACIA_CMD_REM    .equ    1<<4
         00000008          = ACIA_CMD_TIC1   .equ    1<<3
         00000004          = ACIA_CMD_TIC0   .equ    1<<2
         00000002          = ACIA_CMD_IRD    .equ    1<<1
         00000001          = ACIA_CMD_DTR    .equ    1<<0

         00000080          = ACIA_CR_SBN     .equ    1<<7
         00000040          = ACIA_CR_WL1     .equ    1<<6
         00000020          = ACIA_CR_WL0     .equ    1<<5
         00000010          = ACIA_CR_RCS     .equ    1<<4
         00000008          = ACIA_CR_SBR3    .equ    1<<3
         00000004          = ACIA_CR_SBR2    .equ    1<<2
         00000002          = ACIA_CR_SBR1    .equ    1<<1
         00000001          = ACIA_CR_SBR0    .equ    1<<0

                             ;===============================================================================
                             ; Configuration
                             ;-------------------------------------------------------------------------------

         007A1200          = FOSC            .equ    8000000         ; Oscillator speed (8MHz)

                             ;===============================================================================
                             ; Peripherals
                             ;-------------------------------------------------------------------------------

         00007F80          = ACIA1           .equ    $7f80
         00007FA0          = PIA1            .equ    $7fa0
         00007FC0          = VIA1            .equ    $7fc0
         00007FE0          = VIA2            .equ    $7fe0           ; Connected to FTDI 245

         00007F80          = ACIA1_DATA      .equ    ACIA1+ACIA_DATA
         00007F81          = ACIA1_SR        .equ    ACIA1+ACIA_SR
         00007F82          = ACIA1_CMD       .equ    ACIA1+ACIA_CMD
         00007F83          = ACIA1_CR        .equ    ACIA1+ACIA_CR

         00007FA0          = PIA1_ORA        .equ    PIA1+PIA_ORA
         00007FA0          = PIA1_DDRA       .equ    PIA1+PIA_DDRA
         00007FA1          = PIA1_CRA        .equ    PIA1+PIA_CRA
         00007FA2          = PIA1_ORB        .equ    PIA1+PIA_ORB
         00007FA2          = PIA1_DDRB       .equ    PIA1+PIA_DDRB
         00007FA3          = PIA1_CRB        .equ    PIA1+PIA_CRB

         00007FC0          = VIA1_IRB        .equ    VIA1+VIA_IRB
         00007FC0          = VIA1_ORB        .equ    VIA1+VIA_ORB
         00007FC1          = VIA1_ORA        .equ    VIA1+VIA_ORA
         00007FC1          = VIA1_IRA        .equ    VIA1+VIA_IRA
         00007FC2          = VIA1_DDRB       .equ    VIA1+VIA_DDRB

Portable 65xx Assembler [20.01]

         00007FC3          = VIA1_DDRA       .equ    VIA1+VIA_DDRA
         00007FC4          = VIA1_T1CL       .equ    VIA1+VIA_T1CL
         00007FC5          = VIA1_T1CH       .equ    VIA1+VIA_T1CH
         00007FC6          = VIA1_T1LL       .equ    VIA1+VIA_T1LL
         00007FC7          = VIA1_T1LH       .equ    VIA1+VIA_T1LH
         00007FC8          = VIA1_T2CL       .equ    VIA1+VIA_T2CL
         00007FC9          = VIA1_T2CH       .equ    VIA1+VIA_T2CH
         00007FCA          = VIA1_SR         .equ    VIA1+VIA_SR
         00007FCB          = VIA1_ACR        .equ    VIA1+VIA_ACR
         00007FCC          = VIA1_PCR        .equ    VIA1+VIA_PCR
         00007FCD          = VIA1_IFR        .equ    VIA1+VIA_IFR
         00007FCE          = VIA1_IER        .equ    VIA1+VIA_IER
         00007FCF          = VIA1_ORAN       .equ    VIA1+VIA_ORAN
         00007FCF          = VIA1_IRAN       .equ    VIA1+VIA_IRAN

         00007FE0          = VIA2_IRB        .equ    VIA2+VIA_IRB
         00007FE0          = VIA2_ORB        .equ    VIA2+VIA_ORB
         00007FE1          = VIA2_ORA        .equ    VIA2+VIA_ORA
         00007FE1          = VIA2_IRA        .equ    VIA2+VIA_IRA
         00007FE2          = VIA2_DDRB       .equ    VIA2+VIA_DDRB
         00007FE3          = VIA2_DDRA       .equ    VIA2+VIA_DDRA
         00007FE4          = VIA2_T1CL       .equ    VIA2+VIA_T1CL
         00007FE5          = VIA2_T1CH       .equ    VIA2+VIA_T1CH
         00007FE6          = VIA2_T1LL       .equ    VIA2+VIA_T1LL
         00007FE7          = VIA2_T1LH       .equ    VIA2+VIA_T1LH
         00007FE8          = VIA2_T2CL       .equ    VIA2+VIA_T2CL
         00007FE9          = VIA2_T2CH       .equ    VIA2+VIA_T2CH
         00007FEA          = VIA2_SR         .equ    VIA2+VIA_SR
         00007FEB          = VIA2_ACR        .equ    VIA2+VIA_ACR
         00007FEC          = VIA2_PCR        .equ    VIA2+VIA_PCR
         00007FED          = VIA2_IFR        .equ    VIA2+VIA_IFR
         00007FEE          = VIA2_IER        .equ    VIA2+VIA_IER
         00007FEF          = VIA2_ORAN       .equ    VIA2+VIA_ORAN
         00007FEF          = VIA2_IRAN       .equ    VIA2+VIA_IRAN

                             ;===============================================================================
                             ; ASCII Control Characters
                             ;-------------------------------------------------------------------------------

         00000001          = SOH             .equ    $01
         00000004          = EOT             .equ    $04
         00000006          = ACK             .equ    $06
         00000007          = BEL             .equ    $07
         00000008          = BS              .equ    $08
         0000000A          = LF              .equ    $0a
         0000000D          = CR              .equ    $0d
         00000011          = DC1             .equ    $11             ; XON
         00000013          = DC3             .equ    $13             ; XOFF
         00000015          = NAK             .equ    $15
         00000018          = CAN             .equ    $18
         0000001B          = ESC             .equ    $1b
         0000007F          = DEL             .equ    $7f

                             ;===============================================================================

Portable 65xx Assembler [20.01]

                             ; Instruction and Mode Constants
                             ;-------------------------------------------------------------------------------

         00000000          = OP_ERR          .equ    $00
         00000002          = OP_ADC          .equ    $02
         00000004          = OP_AND          .equ    $04
         00000006          = OP_ASL          .equ    $06
                                             .if     __65C02__
         00000008          = OP_BBR          .equ    $08
         0000000A          = OP_BBS          .equ    $0A
                                             .endif
         0000000C          = OP_BCC          .equ    $0C
         0000000E          = OP_BCS          .equ    $0E
         00000010          = OP_BEQ          .equ    $10
         00000012          = OP_BIT          .equ    $12
         00000014          = OP_BMI          .equ    $14
         00000016          = OP_BNE          .equ    $16
         00000018          = OP_BPL          .equ    $18
                                             .if     __65C02__|__65SC02__
         0000001A          = OP_BRA          .equ    $1A
                                             .endif
         0000001C          = OP_BRK          .equ    $1C
         0000001E          = OP_BVC          .equ    $1E
         00000020          = OP_BVS          .equ    $20
         00000022          = OP_CLC          .equ    $22
         00000024          = OP_CLD          .equ    $24
         00000026          = OP_CLI          .equ    $26
         00000028          = OP_CLV          .equ    $28
         0000002A          = OP_CMP          .equ    $2A
         0000002C          = OP_CPX          .equ    $2C
         0000002E          = OP_CPY          .equ    $2E
         00000030          = OP_DEC          .equ    $30
         00000032          = OP_DEX          .equ    $32
         00000034          = OP_DEY          .equ    $34
         00000036          = OP_EOR          .equ    $36
         00000038          = OP_INC          .equ    $38
         0000003A          = OP_INX          .equ    $3A
         0000003C          = OP_INY          .equ    $3C
         0000003E          = OP_JMP          .equ    $3E
         00000040          = OP_JSR          .equ    $40
         00000042          = OP_LDA          .equ    $42
         00000044          = OP_LDX          .equ    $44
         00000046          = OP_LDY          .equ    $46
         00000048          = OP_LSR          .equ    $48
         0000004A          = OP_NOP          .equ    $4A
         0000004C          = OP_ORA          .equ    $4C
         0000004E          = OP_PHA          .equ    $4E
         00000050          = OP_PHP          .equ    $50
                                             .if     __65C02__|__65SC02__
         00000052          = OP_PHX          .equ    $52
         00000054          = OP_PHY          .equ    $54
                                             .endif
         00000056          = OP_PLA          .equ    $56
         00000058          = OP_PLP          .equ    $58

Portable 65xx Assembler [20.01]

                                             .if     __65C02__|__65SC02__
         0000005A          = OP_PLX          .equ    $5A
         0000005C          = OP_PLY          .equ    $5C
                                             .endif
                                             .if     __65C02__
         0000005E          = OP_RMB          .equ    $5E
                                             .endif
         00000060          = OP_ROL          .equ    $60
         00000062          = OP_ROR          .equ    $62
         00000064          = OP_RTI          .equ    $64
         00000066          = OP_RTS          .equ    $66
         00000068          = OP_SBC          .equ    $68
         0000006A          = OP_SEC          .equ    $6A
         0000006C          = OP_SED          .equ    $6C
         0000006E          = OP_SEI          .equ    $6E
                                             .if     __65C02__
         00000070          = OP_SMB          .equ    $70
                                             .endif
         00000072          = OP_STA          .equ    $72
                                             .if     __65C02__|__65SC02__
         00000074          = OP_STP          .equ    $74
                                             .endif
         00000076          = OP_STX          .equ    $76
         00000078          = OP_STY          .equ    $78
                                             .if     __65C02__|__65SC02__
         0000007A          = OP_STZ          .equ    $7A
                                             .endif
         0000007C          = OP_TAX          .equ    $7C
         0000007E          = OP_TAY          .equ    $7E
                                             .if     __65C02__|__65SC02__
         00000080          = OP_TRB          .equ    $80
         00000082          = OP_TSB          .equ    $82
                                             .endif
         00000084          = OP_TSX          .equ    $84
         00000086          = OP_TXA          .equ    $86
         00000088          = OP_TXS          .equ    $88
         0000008A          = OP_TYA          .equ    $8A
                                             .if     __65C02__|__65SC02__
         0000008C          = OP_WAI          .equ    $8C
                                             .endif

                             ; Bit patterns for addressing modes

         00000080          = MB_IND          .equ    %10000000
         00000040          = MB_REL          .equ    %01000000
         00000020          = MB_BIT          .equ    %00100000

         00000000          = MB_IMP          .equ    %00000000
         00000001          = MB_ZPG          .equ    %00000001
         00000002          = MB_IMM          .equ    %00000010
         00000003          = MB_ABS          .equ    %00000011

         00000010          = MB_ACC          .equ    %00010000
         00000008          = MB_XRG          .equ    %00001000

Portable 65xx Assembler [20.01]

         00000004          = MB_YRG          .equ    %00000100

                             ; Addressing modes

                                             .if     __65C02__
         00000021          = MO_BIT          .equ    MB_BIT       |MB_ZPG
         00000061          = MO_BRL          .equ    MB_BIT|MB_REL|MB_ZPG
                                             .endif
         00000010          = MO_ACC          .equ           MB_ACC|MB_IMP
         00000000          = MO_IMP          .equ                  MB_IMP
         00000002          = MO_IMM          .equ                  MB_IMM
         00000040          = MO_REL          .equ                  MB_REL
         00000001          = MO_ZPG          .equ                  MB_ZPG
         00000009          = MO_ZPX          .equ           MB_XRG|MB_ZPG
         00000005          = MO_ZPY          .equ           MB_YRG|MB_ZPG
                                             .if     __65C02__|__65SC02__
         00000081          = MO_IZP          .equ    MB_IND       |MB_ZPG
                                             .endif
         00000089          = MO_IZX          .equ    MB_IND|MB_XRG|MB_ZPG
         00000085          = MO_IZY          .equ    MB_IND|MB_YRG|MB_ZPG
         00000003          = MO_ABS          .equ                  MB_ABS
         0000000B          = MO_ABX          .equ           MB_XRG|MB_ABS
         00000007          = MO_ABY          .equ           MB_YRG|MB_ABS
         00000083          = MO_IAB          .equ    MB_IND       |MB_ABS
                                             .if     __65C02__|__65SC02__
         0000008B          = MO_IAX          .equ    MB_IND|MB_XRG|MB_ABS
                                             .endif

                             ;===============================================================================
                             ; Macros
                             ;-------------------------------------------------------------------------------

                             ; The MNEM macro compresses three characters into a 16-bit value.

                             MNEM            .macro  CH1,CH2,CH3
                                             .word   ((((CH3 & $1f) << 5)|(CH2 & $1f)) << 5)|(CH1 & $1f)
                                             .endm

                             ;===============================================================================
                             ; Data Areas
                             ;-------------------------------------------------------------------------------

                                             .page0
                                             .org    $00f0

00:00F0  00                : A_REG           .space  1                       ; Saved registers
00:00F1  00                : X_REG           .space  1
00:00F2  00                : Y_REG           .space  1
00:00F3  00                : P_REG           .space  1
00:00F4  0000              : PC_REG          .space  2

00:00F6  00                : CMD_LEN         .space  1                       ; Command buffer length
00:00F7  0000              : ADDR_S          .space  2
00:00F9  0000              : ADDR_E          .space  2

Portable 65xx Assembler [20.01]


00:00FB  0000              : TEMP            .space  2
00:00FD  00                : COUNT           .space  1

                             ;-------------------------------------------------------------------------------

         00007E70          = IRQV            .equ    $7e70           ; Vectors
         00007E72          = NMIV            .equ    $7e72

                             ;===============================================================================
                             ; UART Buffers
                             ;-------------------------------------------------------------------------------

                                             .bss
                                             .org    $0200

         00000080          = CMD_SIZE        .equ    128

00:0200  0000000000000000> : COMMAND         .space  CMD_SIZE        ; Command buffer area

                             ;===============================================================================
                             ; Compressed Mnemonics
                             ;-------------------------------------------------------------------------------

                                             .code

00:0000' 4C????            :                 jmp     RESET

                             MNEMONICS:
                                             MNEM    '?','?','?'
00:0003' FF7F              +                 .word   (((('?' & $1f) << 5)|('?' & $1f)) << 5)|('?' & $1f)
                                             MNEM    'A','D','C'
00:0005' 810C              +                 .word   (((('C' & $1f) << 5)|('D' & $1f)) << 5)|('A' & $1f)
                                             MNEM    'A','N','D'
00:0007' C111              +                 .word   (((('D' & $1f) << 5)|('N' & $1f)) << 5)|('A' & $1f)
                                             MNEM    'A','S','L'
00:0009' 6132              +                 .word   (((('L' & $1f) << 5)|('S' & $1f)) << 5)|('A' & $1f)
                                             MNEM    'B','B','R'
00:000B' 4248              +                 .word   (((('R' & $1f) << 5)|('B' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','B','S'
00:000D' 424C              +                 .word   (((('S' & $1f) << 5)|('B' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','C','C'
00:000F' 620C              +                 .word   (((('C' & $1f) << 5)|('C' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','C','S'
00:0011' 624C              +                 .word   (((('S' & $1f) << 5)|('C' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','E','Q'
00:0013' A244              +                 .word   (((('Q' & $1f) << 5)|('E' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','I','T'
00:0015' 2251              +                 .word   (((('T' & $1f) << 5)|('I' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','M','I'
00:0017' A225              +                 .word   (((('I' & $1f) << 5)|('M' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','N','E'
00:0019' C215              +                 .word   (((('E' & $1f) << 5)|('N' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','P','L'

Portable 65xx Assembler [20.01]

00:001B' 0232              +                 .word   (((('L' & $1f) << 5)|('P' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','R','A'
00:001D' 4206              +                 .word   (((('A' & $1f) << 5)|('R' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','R','K'
00:001F' 422E              +                 .word   (((('K' & $1f) << 5)|('R' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','V','C'
00:0021' C20E              +                 .word   (((('C' & $1f) << 5)|('V' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'B','V','S'
00:0023' C24E              +                 .word   (((('S' & $1f) << 5)|('V' & $1f)) << 5)|('B' & $1f)
                                             MNEM    'C','L','C'
00:0025' 830D              +                 .word   (((('C' & $1f) << 5)|('L' & $1f)) << 5)|('C' & $1f)
                                             MNEM    'C','L','D'
00:0027' 8311              +                 .word   (((('D' & $1f) << 5)|('L' & $1f)) << 5)|('C' & $1f)
                                             MNEM    'C','L','I'
00:0029' 8325              +                 .word   (((('I' & $1f) << 5)|('L' & $1f)) << 5)|('C' & $1f)
                                             MNEM    'C','L','V'
00:002B' 8359              +                 .word   (((('V' & $1f) << 5)|('L' & $1f)) << 5)|('C' & $1f)
                                             MNEM    'C','M','P'
00:002D' A341              +                 .word   (((('P' & $1f) << 5)|('M' & $1f)) << 5)|('C' & $1f)
                                             MNEM    'C','P','X'
00:002F' 0362              +                 .word   (((('X' & $1f) << 5)|('P' & $1f)) << 5)|('C' & $1f)
                                             MNEM    'C','P','Y'
00:0031' 0366              +                 .word   (((('Y' & $1f) << 5)|('P' & $1f)) << 5)|('C' & $1f)
                                             MNEM    'D','E','C'
00:0033' A40C              +                 .word   (((('C' & $1f) << 5)|('E' & $1f)) << 5)|('D' & $1f)
                                             MNEM    'D','E','X'
00:0035' A460              +                 .word   (((('X' & $1f) << 5)|('E' & $1f)) << 5)|('D' & $1f)
                                             MNEM    'D','E','Y'
00:0037' A464              +                 .word   (((('Y' & $1f) << 5)|('E' & $1f)) << 5)|('D' & $1f)
                                             MNEM    'E','O','R'
00:0039' E549              +                 .word   (((('R' & $1f) << 5)|('O' & $1f)) << 5)|('E' & $1f)
                                             MNEM    'I','N','C'
00:003B' C90D              +                 .word   (((('C' & $1f) << 5)|('N' & $1f)) << 5)|('I' & $1f)
                                             MNEM    'I','N','X'
00:003D' C961              +                 .word   (((('X' & $1f) << 5)|('N' & $1f)) << 5)|('I' & $1f)
                                             MNEM    'I','N','Y'
00:003F' C965              +                 .word   (((('Y' & $1f) << 5)|('N' & $1f)) << 5)|('I' & $1f)
                                             MNEM    'J','M','P'
00:0041' AA41              +                 .word   (((('P' & $1f) << 5)|('M' & $1f)) << 5)|('J' & $1f)
                                             MNEM    'J','S','R'
00:0043' 6A4A              +                 .word   (((('R' & $1f) << 5)|('S' & $1f)) << 5)|('J' & $1f)
                                             MNEM    'L','D','A'
00:0045' 8C04              +                 .word   (((('A' & $1f) << 5)|('D' & $1f)) << 5)|('L' & $1f)
                                             MNEM    'L','D','X'
00:0047' 8C60              +                 .word   (((('X' & $1f) << 5)|('D' & $1f)) << 5)|('L' & $1f)
                                             MNEM    'L','D','Y'
00:0049' 8C64              +                 .word   (((('Y' & $1f) << 5)|('D' & $1f)) << 5)|('L' & $1f)
                                             MNEM    'L','S','R'
00:004B' 6C4A              +                 .word   (((('R' & $1f) << 5)|('S' & $1f)) << 5)|('L' & $1f)
                                             MNEM    'N','O','P'
00:004D' EE41              +                 .word   (((('P' & $1f) << 5)|('O' & $1f)) << 5)|('N' & $1f)
                                             MNEM    'O','R','A'
00:004F' 4F06              +                 .word   (((('A' & $1f) << 5)|('R' & $1f)) << 5)|('O' & $1f)
                                             MNEM    'P','H','A'

Portable 65xx Assembler [20.01]

00:0051' 1005              +                 .word   (((('A' & $1f) << 5)|('H' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'P','H','P'
00:0053' 1041              +                 .word   (((('P' & $1f) << 5)|('H' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'P','H','X'
00:0055' 1061              +                 .word   (((('X' & $1f) << 5)|('H' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'P','H','Y'
00:0057' 1065              +                 .word   (((('Y' & $1f) << 5)|('H' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'P','L','A'
00:0059' 9005              +                 .word   (((('A' & $1f) << 5)|('L' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'P','L','P'
00:005B' 9041              +                 .word   (((('P' & $1f) << 5)|('L' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'P','L','X'
00:005D' 9061              +                 .word   (((('X' & $1f) << 5)|('L' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'P','L','Y'
00:005F' 9065              +                 .word   (((('Y' & $1f) << 5)|('L' & $1f)) << 5)|('P' & $1f)
                                             MNEM    'R','M','B'
00:0061' B209              +                 .word   (((('B' & $1f) << 5)|('M' & $1f)) << 5)|('R' & $1f)
                                             MNEM    'R','O','L'
00:0063' F231              +                 .word   (((('L' & $1f) << 5)|('O' & $1f)) << 5)|('R' & $1f)
                                             MNEM    'R','O','R'
00:0065' F249              +                 .word   (((('R' & $1f) << 5)|('O' & $1f)) << 5)|('R' & $1f)
                                             MNEM    'R','T','I'
00:0067' 9226              +                 .word   (((('I' & $1f) << 5)|('T' & $1f)) << 5)|('R' & $1f)
                                             MNEM    'R','T','S'
00:0069' 924E              +                 .word   (((('S' & $1f) << 5)|('T' & $1f)) << 5)|('R' & $1f)
                                             MNEM    'S','B','C'
00:006B' 530C              +                 .word   (((('C' & $1f) << 5)|('B' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','E','C'
00:006D' B30C              +                 .word   (((('C' & $1f) << 5)|('E' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','E','D'
00:006F' B310              +                 .word   (((('D' & $1f) << 5)|('E' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','E','I'
00:0071' B324              +                 .word   (((('I' & $1f) << 5)|('E' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','M','B'
00:0073' B309              +                 .word   (((('B' & $1f) << 5)|('M' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','T','A'
00:0075' 9306              +                 .word   (((('A' & $1f) << 5)|('T' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','T','P'
00:0077' 9342              +                 .word   (((('P' & $1f) << 5)|('T' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','T','X'
00:0079' 9362              +                 .word   (((('X' & $1f) << 5)|('T' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','T','Y'
00:007B' 9366              +                 .word   (((('Y' & $1f) << 5)|('T' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'S','T','Z'
00:007D' 936A              +                 .word   (((('Z' & $1f) << 5)|('T' & $1f)) << 5)|('S' & $1f)
                                             MNEM    'T','A','X'
00:007F' 3460              +                 .word   (((('X' & $1f) << 5)|('A' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'T','A','Y'
00:0081' 3464              +                 .word   (((('Y' & $1f) << 5)|('A' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'T','R','B'
00:0083' 540A              +                 .word   (((('B' & $1f) << 5)|('R' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'T','S','B'
00:0085' 740A              +                 .word   (((('B' & $1f) << 5)|('S' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'T','S','X'

Portable 65xx Assembler [20.01]

00:0087' 7462              +                 .word   (((('X' & $1f) << 5)|('S' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'T','X','A'
00:0089' 1407              +                 .word   (((('A' & $1f) << 5)|('X' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'T','X','S'
00:008B' 144F              +                 .word   (((('S' & $1f) << 5)|('X' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'T','Y','A'
00:008D' 3407              +                 .word   (((('A' & $1f) << 5)|('Y' & $1f)) << 5)|('T' & $1f)
                                             MNEM    'W','A','I'
00:008F' 3724              +                 .word   (((('I' & $1f) << 5)|('A' & $1f)) << 5)|('W' & $1f)

                             ;===============================================================================
                             ; Power On Reset
                             ;-------------------------------------------------------------------------------

                             RESET:
00:0091' 78                :                 sei
00:0092' D8                :                 cld                     ; Ensure binary mode

00:0093' A2FF              :                 ldx     #$ff            ; Reset the stack
00:0095' 9A                :                 txs

                                             repeat                  ; Setup vectors
00:0096' BD????            :                  lda    VECTORS,x
00:0099' 9D707E            :                  sta    IRQV,x
00:009C' E8                :                  inx
00:009D' E004              :                  cpx    #4
00:009F' D0F5              :                 until eq

00:00A1' 20????            :                 jsr     NewLine
00:00A4' A200              :                 ldx     #TTL_STR
00:00A6' 20????            :                 jsr     ShowString
00:00A9' 20????            :                 jsr     NewLine

                                             repeat
00:00AC' 0000              :                  brk    #0              ; And enter monitor
00:00AE' 80FC              :                 forever

                             ;-------------------------------------------------------------------------------

00:00B0' ????              : VECTORS:        .word   IRQ             ; Default vectors
00:00B2' ????              :                 .word   NMI

                             ;===============================================================================
                             ; Entry Point
                             ;-------------------------------------------------------------------------------

                             BRK:
00:00B4' 68                :                 pla                     ; Pull off saved registers
00:00B5' 85F2              :                 sta     Y_REG
00:00B7' 68                :                 pla
00:00B8' 85F1              :                 sta     X_REG
00:00BA' 68                :                 pla
00:00BB' 85F0              :                 sta     A_REG
00:00BD' 68                :                 pla

Portable 65xx Assembler [20.01]

00:00BE' 85F3              :                 sta     P_REG
00:00C0' 38                :                 sec                     ; Move PC back to BRK
00:00C1' 68                :                 pla
00:00C2' E902              :                 sbc     #2
00:00C4' 85F4              :                 sta     PC_REG+0
00:00C6' 68                :                 pla
00:00C7' E900              :                 sbc     #0
00:00C9' 85F5              :                 sta     PC_REG+1

                                     ;       cli                     ; Allow interrupts

                             ;===============================================================================
                             ; Show Registers
                             ;-------------------------------------------------------------------------------

                             ShowRegisters:
00:00CB' 20????            :                 jsr     NewLine
00:00CE' A214              :                 ldx     #PC_STR         ; Display the PC
00:00D0' 20????            :                 jsr     ShowString
00:00D3' A5F5              :                 lda     PC_REG+1
00:00D5' 20????            :                 jsr     ShowHex2
00:00D8' A5F4              :                 lda     PC_REG+0
00:00DA' 20????            :                 jsr     ShowHex2

00:00DD' BA                :                 tsx
00:00DE' 20????            :                 jsr     DumpRegisters

                             ;===============================================================================
                             ; Command Line
                             ;-------------------------------------------------------------------------------

                             NewCommand:
                                             .if     __65C02__|__65SC02__
00:00E1' 64F6              :                 stz     CMD_LEN         ; Mark the buffer as empty
                                             .else
                           -                 lda     #0              ; Mark the buffer as empty
                           -                 sta     CMD_LEN
                                             .endif

                             RptCommand:
00:00E3' 20????            :                 jsr     NewLine         ; Move cursor to next line
00:00E6' A92E              :                 lda     #'.'            ; And output the prompt
00:00E8' 20????            :                 jsr     UartTx

00:00EB' A200              :                 ldx     #0              ; Output prepared command
                                             repeat
00:00ED' E4F6              :                  cpx    CMD_LEN         ; Any saved characters to display?
00:00EF' B009              :                  break  cs              ; No
00:00F1' BD0002            :                  lda    COMMAND,x       ; Yes, print from the buffer
00:00F4' 20????            :                  jsr    UartTx
00:00F7' E8                :                  inx
00:00F8' 80F3              :                 forever

00:00FA' A911              :                 lda     #DC1            ; Send XON

Portable 65xx Assembler [20.01]

00:00FC' 20????            :                 jsr     UartTx
                                             repeat
00:00FF' 20????            :                  jsr    UartRx          ; Wait for some user input
00:0102' 9D0002            :                  sta    COMMAND,x

00:0105' C90D              :                  cmp    #CR             ; End of input?
00:0107' F037              :                  break eq
00:0109' C90A              :                  cmp    #LF             ; Ignore LF
00:010B' F0F2              :                  continue eq

00:010D' C91B              :                  cmp    #ESC            ; Cancel input?
00:010F' D002              :                  if     eq
00:0111' F0CE              :                   beq   NewCommand      ; Yes
                                              endif

00:0113' C97F              :                  cmp    #DEL            ; Turn a delete
00:0115' D002              :                  if     eq
00:0117' A908              :                   lda   #BS             ; .. into a backspace
                                              endif

00:0119' C908              :                  cmp    #BS             ; Handle backspace
00:011B' D012              :                  if     eq
00:011D' E000              :                   cpx   #0
00:011F' F00C              :                   if    ne
00:0121' 48                :                    pha
00:0122' 20????            :                    jsr  UartTx
00:0125' 20????            :                    jsr  Space
00:0128' 68                :                    pla
00:0129' 20????            :                    jsr  UartTx
00:012C' CA                :                    dex
                                               endif
00:012D' 80D0              :                   continue
                                              endif

00:012F' C920              :                  cmp    #' '            ; Beep if non-printable
00:0131' B007              :                  if     cc
00:0133' A907              :                   lda   #BEL
00:0135' 20????            :                   jsr   UartTx
00:0138' 80C5              :                   continue
                                              endif

00:013A' 20????            :                  jsr    UartTx          ; Otherwise echo to screen
00:013D' E8                :                  inx                    ; And bump counter
00:013E' 80BF              :                 forever

00:0140' 86F6              :                 stx     CMD_LEN         ; Save the command length
00:0142' A913              :                 lda     #DC3            ; Send XOFF
00:0144' 20????            :                 jsr     UartTx

00:0147' A200              :                 ldx     #0              ; Set character offset to start
00:0149' 20????            :                 jsr     SkipSpaces      ; And get first character
00:014C' B093              :                 bcs     NewCommand

00:014E' C90D              :                 cmp     #CR             ; Empty line?

Portable 65xx Assembler [20.01]

00:0150' F08F              :                 beq     NewCommand      ; Yes

                             ;===============================================================================
                             ; 'D' - Disassemble Memory
                             ;-------------------------------------------------------------------------------

00:0152' C944              :                 cmp     #'D'
00:0154' D037              :                 if      eq
00:0156' 20????            :                  jsr    GetWord
00:0159' B02F              :                  if     cc
00:015B' 20????            :                   jsr   SetStartAddr
00:015E' 20????            :                   jsr   SetEndAddr
00:0161' 20????            :                   jsr   GetWord
00:0164' B005              :                   if    cc
00:0166' 20????            :                    jsr  SetEndAddr
00:0169' 8002              :                   else
00:016B' E6FA              :                    inc  ADDR_E+1
                                               endif

                                               repeat
00:016D' 20????            :                    jsr  NewLine         ; Print the memory address
00:0170' A5F8              :                    lda  ADDR_S+1
00:0172' 20????            :                    jsr  ShowHex2
00:0175' A5F7              :                    lda  ADDR_S+0
00:0177' 20????            :                    jsr  ShowHex2

00:017A' 20????            :                    jsr  Disassemble
00:017D' 20????            :                    jsr  BumpAddr
00:0180' B005              :                    break cs
00:0182' 20????            :                    jsr  CheckEnd
00:0185' 90E6              :                   until cs
00:0187' 4C????            :                   jmp   NewCommand
                                              endif
00:018A' 4C????            :                  jmp    Error
                                             endif

                             ;===============================================================================
                             ; 'F' - Fill
                             ;-------------------------------------------------------------------------------

00:018D' C946              :                 cmp     #'F'
00:018F' D02F              :                 if      eq
00:0191' 20????            :                  jsr    GetWord         ; Extract start address
00:0194' B024              :                  if cc
00:0196' 20????            :                   jsr   SetStartAddr
00:0199' 20????            :                   jsr   GetWord         ; Extract end address
00:019C' B01C              :                   bcs   .FillFail
00:019E' 20????            :                   jsr   SetEndAddr
00:01A1' 20????            :                   jsr   GetByte         ; Extract fill byte
00:01A4' B014              :                   bcs   .FillFail

                                               repeat
00:01A6' A000              :                    ldy  #0              ; Perform the fill
00:01A8' A5FB              :                    lda  TEMP+0

Portable 65xx Assembler [20.01]

00:01AA' 91F7              :                    sta  (ADDR_S),y

00:01AC' C8                :                    iny
00:01AD' 98                :                    tya
00:01AE' 20????            :                    jsr  BumpAddr        ; Until the end
00:01B1' B005              :                    break cs
00:01B3' 20????            :                    jsr  CheckEnd
00:01B6' 90EE              :                   until cs
00:01B8' 8003              :                  else
00:01BA' 4C????            : .FillFail:        jmp   Error
                                              endif
00:01BD' 4C????            :                  jmp    NewCommand
                                             endif

                             ;===============================================================================
                             ; 'G' - Go
                             ;-------------------------------------------------------------------------------

00:01C0' C947              :                 cmp     #'G'
00:01C2' D022              :                 if      eq
00:01C4' 20????            :                  jsr    GetWord         ; Extract start address
00:01C7' B008              :                  if cc
00:01C9' A5FC              :                   lda   TEMP+1
00:01CB' 48                :                   pha
00:01CC' A5FB              :                   lda   TEMP+0
00:01CE' 48                :                   pha
00:01CF' 8006              :                  else
00:01D1' A5F5              :                   lda   PC_REG+1        ; Push the target address
00:01D3' 48                :                   pha
00:01D4' A5F4              :                   lda   PC_REG+0
00:01D6' 48                :                   pha
                                              endif

00:01D7' A911              :                  lda    #DC1            ; Send XON
00:01D9' 20????            :                  jsr    UartTx

00:01DC' A5F3              :                  lda    P_REG           ; And status flags
00:01DE' 48                :                  pha
00:01DF' A5F0              :                  lda    A_REG           ; Reload A, X and Y
00:01E1' A6F1              :                  ldx    X_REG
00:01E3' A4F2              :                  ldy    Y_REG
00:01E5' 40                :                  rti                    ; Then go to code
                                             endif

                             ;===============================================================================
                             ; 'M' - Show Memory
                             ;-------------------------------------------------------------------------------

00:01E6' C94D              :                 cmp     #'M'
00:01E8' D060              :                 if      eq
00:01EA' 20????            :                  jsr    GetWord         ; Extract start address
00:01ED' B058              :                  if     cc
00:01EF' 20????            :                   jsr   SetStartAddr
00:01F2' 20????            :                   jsr   SetEndAddr

Portable 65xx Assembler [20.01]

00:01F5' 20????            :                   jsr   GetWord         ; Extract end address
00:01F8' B005              :                   if    cc
00:01FA' 20????            :                    jsr  SetEndAddr
00:01FD' 8002              :                   else
00:01FF' E6FA              :                    inc  ADDR_E+1        ; Or default to start + 256
                                               endif

                                               repeat
00:0201' 20????            :                    jsr  NewLine         ; Print the memory address
00:0204' A5F8              :                    lda  ADDR_S+1
00:0206' 20????            :                    jsr  ShowHex2
00:0209' A5F7              :                    lda  ADDR_S+0
00:020B' 20????            :                    jsr  ShowHex2

00:020E' A000              :                    ldy  #0              ; Dump 16 bytes of data
                                                repeat
00:0210' 20????            :                     jsr Space
00:0213' B1F7              :                     lda (ADDR_S),Y
00:0215' C8                :                     iny
00:0216' 20????            :                     jsr ShowHex2
00:0219' C010              :                     cpy #16
00:021B' D0F3              :                    until eq

00:021D' 20????            :                    jsr  Space           ; Then show as characters
00:0220' 20????            :                    jsr  Bar
00:0223' A000              :                    ldy  #0
                                                repeat
00:0225' B1F7              :                     lda (ADDR_S),Y
00:0227' C8                :                     iny
00:0228' 20????            :                     jsr IsPrintable
00:022B' B002              :                     if  cc
00:022D' A92E              :                      lda #'.'
                                                 endif
00:022F' 20????            :                     jsr UartTx
00:0232' C010              :                     cpy #16
00:0234' D0EF              :                    until eq
00:0236' 20????            :                    jsr  Bar

00:0239' 98                :                    tya
00:023A' 20????            :                    jsr  BumpAddr
00:023D' B005              :                    break cs
00:023F' 20????            :                    jsr  CheckEnd
00:0242' 90BD              :                   until cs
00:0244' 4C????            :                   jmp   NewCommand
                                              endif
00:0247' 4C????            :                  jmp    Error
                                             endif

                             ;===============================================================================
                             ; 'R' - Show Registers
                             ;-------------------------------------------------------------------------------

00:024A' C952              :                 cmp     #'R'
00:024C' D003              :                 if      eq

Portable 65xx Assembler [20.01]

00:024E' 4C????            :                  jmp    ShowRegisters
                                             endif

                             ;===============================================================================
                             ; 'S' - S19 Record Loader
                             ;-------------------------------------------------------------------------------

00:0251' C953              :                 cmp     #'S'
00:0253' D051              :                 if      eq
00:0255' 20????            :                  jsr    NextChar
00:0258' C931              :                  cmp    #'1'            ; Data record?
00:025A' D02C              :                  if     eq
00:025C' 20????            :                   jsr   GetByte         ; Extract length
00:025F' B03F              :                   bcs   .S19Fail
00:0261' 85F9              :                   sta   ADDR_E+0
00:0263' 20????            :                   jsr   GetWord         ; Extract address
00:0266' B038              :                   bcs   .S19Fail
00:0268' 20????            :                   jsr   SetStartAddr
00:026B' C6F9              :                   dec   ADDR_E+0        ; Reduce count
00:026D' C6F9              :                   dec   ADDR_E+0
00:026F' C6F9              :                   dec   ADDR_E+0

00:0271' A000              :                   ldy   #0
00:0273' 84FA              :                   sty   ADDR_E+1
                                               repeat
00:0275' 20????            :                    jsr  GetByte         ; Extract data byte
00:0278' B026              :                    bcs  .S19Fail
00:027A' A4FA              :                    ldy  ADDR_E+1        ; And save
00:027C' A5FB              :                    lda  TEMP+0
00:027E' 91F7              :                    sta  (ADDR_S),y
00:0280' E6FA              :                    inc  ADDR_E+1
00:0282' C6F9              :                    dec  ADDR_E+0        ; Until line processed
00:0284' D0EF              :                   until eq
00:0286' 801B              :                  else
00:0288' C939              :                   cmp   #'9'
00:028A' D014              :                   if    eq
00:028C' 20????            :                    jsr  GetByte         ; Extract length
00:028F' B00F              :                    bcs  .S19Fail
00:0291' 20????            :                    jsr  GetWord         ; Extract start address
00:0294' B00A              :                    bcs  .S19Fail
00:0296' A5FB              :                    lda  TEMP+0          ; Copy to PC
00:0298' 85F4              :                    sta  PC_REG+0
00:029A' A5FC              :                    lda  TEMP+1
00:029C' 85F5              :                    sta  PC_REG+1
00:029E' 8003              :                   else
00:02A0' 4C????            : .S19Fail:          jmp  Error
                                               endif
                                              endif
00:02A3' 4C????            :                  jmp    NewCommand
                                             endif

                             ;===============================================================================
                             ; 'T' - Trace
                             ;-------------------------------------------------------------------------------

Portable 65xx Assembler [20.01]


00:02A6' C954              :                 cmp     #'T'
00:02A8' F0034C????        :                 if eq
00:02AD' 20????            :                  jsr    GetWord         ; Extract start address
00:02B0' B008              :                  if cc
00:02B2' A4FB              :                   ldy   TEMP+0          ; And overwrite PC
00:02B4' 84F4              :                   sty   PC_REG+0
00:02B6' A4FC              :                   ldy   TEMP+1
00:02B8' 84F5              :                   sty   PC_REG+1
                                              endif

00:02BA' C92C              :                  cmp    #','
00:02BC' 38                :                  sec
00:02BD' D003              :                  if eq
00:02BF' 20????            :                   jsr   GetWord         ; Extract count
                                              endif
00:02C2' 9007              :                  if cs
00:02C4' A001              :                   ldy   #1              ; Default one step
00:02C6' 84FB              :                   sty   TEMP+0
00:02C8' 88                :                   dey
00:02C9' 84FC              :                   sty   TEMP+1
                                              endif

                             Trace:
00:02CB' 20????            :                  jsr    NewLine         ; Show the current PC
00:02CE' A5F5              :                  lda    PC_REG+1
00:02D0' 85F8              :                  sta    ADDR_S+1
00:02D2' 20????            :                  jsr    ShowHex2
00:02D5' A5F4              :                  lda    PC_REG+0
00:02D7' 85F7              :                  sta    ADDR_S+0
00:02D9' 20????            :                  jsr    ShowHex2

00:02DC' 20????            :                  jsr    Disassemble     ; Disassembly opcode
                                              repeat
00:02DF' E010              :                   cpx   #16             ; .. justify output
00:02E1' B006              :                   break cs
00:02E3' 20????            :                   jsr   Space
00:02E6' E8                :                   inx
00:02E7' 80F6              :                  forever
00:02E9' BA                :                  tsx
00:02EA' 20????            :                  jsr    DumpRegisters   ; .. and show registers

00:02ED' A9F0              :                  lda    #<A_REG         ; Assume accumulator is target
00:02EF' 85F7              :                  sta    ADDR_S+0
00:02F1' A900              :                  lda    #>A_REG
00:02F3' 85F8              :                  sta    ADDR_S+1

00:02F5' A000              :                  ldy    #0
00:02F7' B1F4              :                  lda    (PC_REG),y      ; Fetch the next opcode
00:02F9' E6F4              :                  inc    PC_REG+0        ; .. and bump PC
00:02FB' D002              :                  if eq
00:02FD' E6F5              :                   inc   PC_REG+1
                                              endif
00:02FF' AA                :                  tax

Portable 65xx Assembler [20.01]

00:0300' BD????            :                  lda    MODES,X         ; Extract address type
00:0303' 2903              :                  and    #MB_ABS
00:0305' C901              :                  cmp    #MB_ZPG         ; Zero page?
00:0307' D00E              :                  if eq
00:0309' B1F4              :                   lda   (PC_REG),y
00:030B' 85F7              :                   sta   ADDR_S+0
00:030D' 84F8              :                   sty   ADDR_S+1
00:030F' E6F4              :                   inc   PC_REG+0
00:0311' D002              :                   if eq
00:0313' E6F5              :                    inc  PC_REG+1
                                               endif
00:0315' 802C              :                  else
00:0317' C903              :                   cmp   #MB_ABS         ; Absolute ?
00:0319' D016              :                   if eq
00:031B' B1F4              :                    lda  (PC_REG),y
00:031D' 85F7              :                    sta  ADDR_S+0
00:031F' E6F4              :                    inc  PC_REG+0
00:0321' D002              :                    if eq
00:0323' E6F5              :                     inc PC_REG+1
                                                endif
00:0325' B1F4              :                    lda  (PC_REG),y
00:0327' 85F8              :                    sta  ADDR_S+1
00:0329' E6F4              :                    inc  PC_REG+0
00:032B' D002              :                    if eq
00:032D' E6F5              :                     inc PC_REG+1
                                                endif
00:032F' 8012              :                   else
00:0331' C902              :                    cmp  #MB_IMM         ; Immediate?
00:0333' D00E              :                    if eq
00:0335' A5F4              :                     lda PC_REG+0
00:0337' 85F7              :                     sta ADDR_S+0
00:0339' A5F5              :                     lda PC_REG+1
00:033B' 85F8              :                     sta ADDR_S+1
00:033D' E6F4              :                     inc PC_REG+0
00:033F' D002              :                     if eq
00:0341' E6F5              :                      inc PC_REG+1
                                                 endif
                                                endif
                                               endif
                                              endif

00:0343' A908              :                  lda    #MB_XRG         ; Handle X index
00:0345' 3D????            :                  and    MODES,x
00:0348' F01D              :                  if ne
00:034A' 18                :                   clc
00:034B' A5F1              :                   lda   X_REG
00:034D' 65F7              :                   adc   ADDR_S+0
00:034F' 85F7              :                   sta   ADDR_S+0
00:0351' 9002              :                   if cs
00:0353' E6F8              :                    inc  ADDR_S+1
                                               endif

00:0355' A909              :                   lda   #MO_ZPX         ; Force wrap around for ZPG,X
00:0357' DD????            :                   cmp   MODES,x

Portable 65xx Assembler [20.01]

00:035A' D002              :                   if eq
00:035C' 84F8              :                    sty  ADDR_S+1
                                               endif

00:035E' A989              :                   lda   #MO_IZX         ; .. and (ZPG,X)
00:0360' DD????            :                   cmp   MODES,x
00:0363' D002              :                   if eq
00:0365' 84F8              :                    sty  ADDR_S+1
                                               endif
                                              endif

00:0367' A980              :                  lda    #MB_IND         ; Handle indirection
00:0369' 3D????            :                  and    MODES,x
00:036C' F01C              :                  if ne
00:036E' B1F7              :                   lda   (ADDR_S),y      ; Fetch low byte of target
00:0370' 48                :                   pha

                                             .if     __65C02__|__65SC02__
00:0371' E06C              :                   cpx   #$6C            ; JMP (abs)?
00:0373' F002              :                   if ne
00:0375' E07C              :                    cpx  #$7C            ; or JMP (abs,X)?
                                               endif
00:0377' D008              :                   if eq
00:0379' E6F7              :                    inc  ADDR_S+0        ; 65C02 increments properly
00:037B' D002              :                    if eq
00:037D' E6F8              :                     inc ADDR_S+1
                                                endif
00:037F' 8002              :                   else
00:0381' E6F7              :                    inc  ADDR_S+0        ; Otherwise just the low byte
                                               endif
                                             .else
                           -                   inc   ADDR_S+0        ; 6502 bumps just the low byte
                                             .endif

00:0383' B1F7              :                   lda   (ADDR_S),y      ; Fetch high byte of target
00:0385' 85F8              :                   sta   ADDR_S+1        ; And save indirect address
00:0387' 68                :                   pla
00:0388' 85F7              :                   sta   ADDR_S+0
                                              endif

00:038A' A904              :                  lda    #MB_YRG         ; Handle Y index
00:038C' 3D????            :                  and    MODES,x
00:038F' F014              :                  if ne
00:0391' 18                :                   clc
00:0392' A5F2              :                   lda   Y_REG
00:0394' 65F7              :                   adc   ADDR_S+0
00:0396' 85F7              :                   sta   ADDR_S+0
00:0398' 9002              :                   if cs
00:039A' E6F8              :                    inc  ADDR_S+1
                                               endif

00:039C' A901              :                   lda   #MB_ZPG         ; Restrict to zero page
00:039E' 3D????            :                   and   MODES,x
00:03A1' F002              :                   if ne

Portable 65xx Assembler [20.01]

00:03A3' A4F8              :                    ldy  ADDR_S+1
                                               endif
                                              endif

00:03A5' A940              :                  lda    #MB_REL         ; Relative address?
00:03A7' 3D????            :                  and    MODES,x
00:03AA' F015              :                  if ne
00:03AC' B1F4              :                   lda   (PC_REG),y
00:03AE' 1001              :                   if mi
00:03B0' 88                :                    dey
                                               endif
00:03B1' E6F4              :                   inc   PC_REG+0
00:03B3' D002              :                   if eq
00:03B5' E6F5              :                    inc  PC_REG+1
                                               endif
00:03B7' 18                :                   clc
00:03B8' 65F4              :                   adc   PC_REG+0
00:03BA' 85F9              :                   sta   ADDR_E+0
00:03BC' 98                :                   tya
00:03BD' 65F5              :                   adc   PC_REG+1
00:03BF' 85FA              :                   sta   ADDR_E+1
                                              endif

00:03C1' BC????            :                  ldy    OPCODES,x       ; Recover the opcode index
00:03C4' B9????            :                  lda    EMULATE+1,y
00:03C7' 48                :                  pha
00:03C8' B9????            :                  lda    EMULATE+0,y
00:03CB' 48                :                  pha
00:03CC' A000              :                  ldy    #0
00:03CE' A5F3              :                  lda    P_REG           ; Restore status flags
00:03D0' 48                :                  pha
00:03D1' A5F0              :                  lda    A_REG           ; .. and A
00:03D3' 28                :                  plp
00:03D4' 60                :                  rts                    ; Go to emulation code

                             EMULATE:
00:03D5' ????              :                 .word   EM_ERR-1
00:03D7' ????              :                 .word   EM_ADC-1
00:03D9' ????              :                 .word   EM_AND-1
00:03DB' ????              :                 .word   EM_ASL-1
00:03DD' ????              :                 .word   EM_BBR-1
00:03DF' ????              :                 .word   EM_BBS-1
00:03E1' ????              :                 .word   EM_BCC-1
00:03E3' ????              :                 .word   EM_BCS-1
00:03E5' ????              :                 .word   EM_BEQ-1
00:03E7' ????              :                 .word   EM_BIT-1
00:03E9' ????              :                 .word   EM_BMI-1
00:03EB' ????              :                 .word   EM_BNE-1
00:03ED' ????              :                 .word   EM_BPL-1
00:03EF' ????              :                 .word   EM_BRA-1
00:03F1' ????              :                 .word   EM_BRK-1
00:03F3' ????              :                 .word   EM_BVC-1
00:03F5' ????              :                 .word   EM_BVS-1
00:03F7' ????              :                 .word   EM_CLC-1

Portable 65xx Assembler [20.01]

00:03F9' ????              :                 .word   EM_CLD-1
00:03FB' ????              :                 .word   EM_CLI-1
00:03FD' ????              :                 .word   EM_CLV-1
00:03FF' ????              :                 .word   EM_CMP-1
00:0401' ????              :                 .word   EM_CPX-1
00:0403' ????              :                 .word   EM_CPY-1
00:0405' ????              :                 .word   EM_DEC-1
00:0407' ????              :                 .word   EM_DEX-1
00:0409' ????              :                 .word   EM_DEY-1
00:040B' ????              :                 .word   EM_EOR-1
00:040D' ????              :                 .word   EM_INC-1
00:040F' ????              :                 .word   EM_INX-1
00:0411' ????              :                 .word   EM_INY-1
00:0413' ????              :                 .word   EM_JMP-1
00:0415' ????              :                 .word   EM_JSR-1
00:0417' ????              :                 .word   EM_LDA-1
00:0419' ????              :                 .word   EM_LDX-1
00:041B' ????              :                 .word   EM_LDY-1
00:041D' ????              :                 .word   EM_LSR-1
00:041F' ????              :                 .word   EM_NOP-1
00:0421' ????              :                 .word   EM_ORA-1
00:0423' ????              :                 .word   EM_PHA-1
00:0425' ????              :                 .word   EM_PHP-1
00:0427' ????              :                 .word   EM_PHX-1
00:0429' ????              :                 .word   EM_PHY-1
00:042B' ????              :                 .word   EM_PLA-1
00:042D' ????              :                 .word   EM_PLP-1
00:042F' ????              :                 .word   EM_PLX-1
00:0431' ????              :                 .word   EM_PLY-1
00:0433' ????              :                 .word   EM_RMB-1
00:0435' ????              :                 .word   EM_ROL-1
00:0437' ????              :                 .word   EM_ROR-1
00:0439' ????              :                 .word   EM_RTI-1
00:043B' ????              :                 .word   EM_RTS-1
00:043D' ????              :                 .word   EM_SBC-1
00:043F' ????              :                 .word   EM_SEC-1
00:0441' ????              :                 .word   EM_SED-1
00:0443' ????              :                 .word   EM_SEI-1
00:0445' ????              :                 .word   EM_SMB-1
00:0447' ????              :                 .word   EM_STA-1
00:0449' ????              :                 .word   EM_STP-1
00:044B' ????              :                 .word   EM_STX-1
00:044D' ????              :                 .word   EM_STY-1
00:044F' ????              :                 .word   EM_STZ-1
00:0451' ????              :                 .word   EM_TAX-1
00:0453' ????              :                 .word   EM_TAY-1
00:0455' ????              :                 .word   EM_TRB-1
00:0457' ????              :                 .word   EM_TSB-1
00:0459' ????              :                 .word   EM_TSX-1
00:045B' ????              :                 .word   EM_TXA-1
00:045D' ????              :                 .word   EM_TXS-1
00:045F' ????              :                 .word   EM_TYA-1
00:0461' ????              :                 .word   EM_WAI-1


Portable 65xx Assembler [20.01]

                             ;-------------------------------------------------------------------------------

                             EM_CLC:
00:0463' 18                :                  clc
00:0464' 4C????            :                  jmp    SaveP

                             EM_CLD:
00:0467' D8                :                  cld
00:0468' 4C????            :                  jmp    SaveP

                             EM_CLI:
00:046B' 58                :                  cli
00:046C' 4C????            :                  jmp    SaveP

                             EM_CLV:
00:046F' B8                :                  clv
00:0470' 4C????            :                  jmp    SaveP

                             EM_SEC:
00:0473' 38                :                  sec
00:0474' 4C????            :                  jmp    SaveP

                             EM_SED:
00:0477' F8                :                  sed
00:0478' 4C????            :                  jmp    SaveP

                             EM_SEI:
00:047B' 78                :                  sei
00:047C' 4C????            :                  jmp    SaveP

                             ;-------------------------------------------------------------------------------

                             EM_ADC:
00:047F' 71F7              :                  adc    (ADDR_S),y
00:0481' 4C????            :                  jmp    SaveAP

                             EM_SBC:
00:0484' F1F7              :                  sbc    (ADDR_S),y
00:0486' 4C????            :                  jmp    SaveAP

                             ;-------------------------------------------------------------------------------

                             EM_CPX:
00:0489' A5F1              :                  lda    X_REG
00:048B' 2C                :                  .byte  $2c             ; BIT trick

                             EM_CPY:
00:048C' A5F2              :                  lda    Y_REG

                             EM_CMP:
00:048E' D1F7              :                  cmp    (ADDR_S),y
00:0490' 4C????            :                  jmp    SaveP

                             ;-------------------------------------------------------------------------------

Portable 65xx Assembler [20.01]


                             EM_AND:
00:0493' 31F7              :                  and    (ADDR_S),y
00:0495' 4C????            :                  jmp    SaveAP

                             EM_EOR:
00:0498' 51F7              :                  eor    (ADDR_S),y
00:049A' 4C????            :                  jmp    SaveAP

                             EM_ORA:
00:049D' 11F7              :                  ora    (ADDR_S),y
00:049F' 4C????            :                  jmp    SaveAP

                             EM_BIT:
                                             .if     __65C02__|__65SC02__
00:04A2' E089              :                  cpx    #$89            ; Immediate does not affect NV
00:04A4' F00C              :                  if ne
00:04A6' 48                :                   pha
00:04A7' B1F7              :                   lda   (ADDR_S),y      ; Extract NV bits from value
00:04A9' 45F3              :                   eor   P_REG
00:04AB' 29C0              :                   and   #$c0
00:04AD' 45F3              :                   eor   P_REG
00:04AF' 85F3              :                   sta   P_REG
00:04B1' 68                :                   pla
                                              endif
                                             .endif
00:04B2' 31F7              :                  and    (ADDR_S),y      ; Handle Z flag
00:04B4' 08                :                  php
00:04B5' 68                :                  pla
00:04B6' 45F3              :                  eor    P_REG
00:04B8' 2902              :                  and    #$02
00:04BA' 45F3              :                  eor    P_REG
00:04BC' 85F3              :                  sta    P_REG
00:04BE' 4C????            :                  jmp    SaveNone

                             ;-------------------------------------------------------------------------------

                             EM_ASL:
00:04C1' B1F7              :                  lda    (ADDR_S),y
00:04C3' 0A                :                  asl    a
00:04C4' 91F7              :                  sta    (ADDR_S),y
00:04C6' 4C????            :                  jmp    SaveP

                             EM_LSR:
00:04C9' B1F7              :                  lda    (ADDR_S),y
00:04CB' 4A                :                  lsr    a
00:04CC' 91F7              :                  sta    (ADDR_S),y
00:04CE' 4C????            :                  jmp    SaveP

                             EM_ROL:
00:04D1' B1F7              :                  lda    (ADDR_S),y
00:04D3' 2A                :                  rol    a
00:04D4' 91F7              :                  sta    (ADDR_S),y
00:04D6' 4C????            :                  jmp    SaveP

Portable 65xx Assembler [20.01]


                             EM_ROR:
00:04D9' B1F7              :                  lda    (ADDR_S),y
00:04DB' 6A                :                  ror    a
00:04DC' 91F7              :                  sta    (ADDR_S),y
00:04DE' 4C????            :                  jmp    SaveP

                             ;-------------------------------------------------------------------------------

                             EM_DEC:
00:04E1' B1F7              :                  lda    (ADDR_S),y
00:04E3' AA                :                  tax
00:04E4' CA                :                  dex
00:04E5' 8A                :                  txa
00:04E6' 91F7              :                  sta    (ADDR_S),y
00:04E8' 4C????            :                  jmp    SaveP

                             EM_DEX:
00:04EB' C6F1              :                  dec    X_REG
00:04ED' 4C????            :                  jmp    SaveP

                             EM_DEY:
00:04F0' C6F2              :                  dec    Y_REG
00:04F2' 4C????            :                  jmp    SaveP

                             EM_INC:
00:04F5' B1F7              :                  lda    (ADDR_S),y
00:04F7' AA                :                  tax
00:04F8' E8                :                  inx
00:04F9' 8A                :                  txa
00:04FA' 91F7              :                  sta    (ADDR_S),y
00:04FC' 4C????            :                  jmp    SaveP

                             EM_INX:
00:04FF' E6F1              :                  inc    X_REG
00:0501' 4C????            :                  jmp    SaveP

                             EM_INY:
00:0504' E6F2              :                  inc    Y_REG
00:0506' 4C????            :                  jmp    SaveP

                             ;-------------------------------------------------------------------------------

                             EM_BCC:
00:0509' 901C              :                  bcc    EM_BRA
00:050B' 4C????            :                  jmp    SaveNone

                             EM_BCS:
00:050E' B017              :                  bcs    EM_BRA
00:0510' 4C????            :                  jmp    SaveNone

                             EM_BEQ:
00:0513' F012              :                  beq    EM_BRA
00:0515' 4C????            :                  jmp    SaveNone

Portable 65xx Assembler [20.01]


                             EM_BMI:
00:0518' 300D              :                  bmi    EM_BRA
00:051A' 4C????            :                  jmp    SaveNone

                             EM_BNE:
00:051D' D008              :                  bne    EM_BRA
00:051F' 4C????            :                  jmp    SaveNone

                             EM_BPL:
00:0522' 1003              :                  bpl    EM_BRA
00:0524' 4C????            :                  jmp    SaveNone

                             EM_BRA:
00:0527' A5F9              :                  lda    ADDR_E+0
00:0529' 85F4              :                  sta    PC_REG+0
00:052B' A5FA              :                  lda    ADDR_E+1
00:052D' 85F5              :                  sta    PC_REG+1
00:052F' 4C????            :                  jmp    SaveNone

                             EM_BVC:
00:0532' 50F3              :                  bvc    EM_BRA
00:0534' 4C????            :                  jmp    SaveNone

                             EM_BVS:
00:0537' 70EE              :                  bvs    EM_BRA
00:0539' 4C????            :                  jmp    SaveNone

                             ;-------------------------------------------------------------------------------

                             EM_JSR:
00:053C' A5F4              :                  lda    PC_REG+0        ; Back up
00:053E' D002              :                  if eq
00:0540' C6F5              :                   dec   PC_REG+1
                                              endif
00:0542' C6F4              :                  dec    PC_REG+0
00:0544' A5F5              :                  lda    PC_REG+1        ; And push PC
00:0546' 48                :                  pha
00:0547' A5F4              :                  lda    PC_REG+0
00:0549' 48                :                  pha

                             EM_JMP:
00:054A' A5F7              :                  lda    ADDR_S+0        ; Set PC to target address
00:054C' 85F4              :                  sta    PC_REG+0
00:054E' A5F8              :                  lda    ADDR_S+1
00:0550' 85F5              :                  sta    PC_REG+1
00:0552' 4C????            :                  jmp    SaveNone

                             ;-------------------------------------------------------------------------------

                             EM_LDA:
00:0555' B1F7              :                  lda    (ADDR_S),y
00:0557' 4C????            :                  jmp    SaveAP


Portable 65xx Assembler [20.01]

                             EM_LDX:
00:055A' B1F7              :                  lda    (ADDR_S),y
00:055C' 85F1              :                  sta    X_REG
00:055E' 4C????            :                  jmp    SaveP

                             EM_LDY:
00:0561' B1F7              :                  lda    (ADDR_S),y
00:0563' 85F2              :                  sta    Y_REG
00:0565' 4C????            :                  jmp    SaveP

                             EM_STA:
00:0568' 91F7              :                  sta    (ADDR_S),y
00:056A' 4C????            :                  jmp    SaveNone

                             EM_STX:
00:056D' A5F1              :                  lda    X_REG
00:056F' 4C????            :                  JMP    EM_STA

                             EM_STY:
00:0572' A5F2              :                  lda    Y_REG
00:0574' 4C????            :                  jmp    EM_STA

                             EM_STZ:
00:0577' A900              :                  lda    #0
00:0579' 4C????            :                  jmp    EM_STA

                             ;-------------------------------------------------------------------------------

                             EM_PHA:
00:057C' 48                :                  pha
00:057D' 4C????            :                  jmp    SaveNone

                             EM_PHP:
00:0580' A5F3              :                  lda    P_REG
00:0582' 48                :                  pha
00:0583' 4C????            :                  jmp    SaveNone

                             EM_PHX:
00:0586' A5F1              :                  lda    X_REG
00:0588' 48                :                  pha
00:0589' 4C????            :                  jmp    SaveNone

                             EM_PHY:
00:058C' A5F2              :                  lda    Y_REG
00:058E' 48                :                  pha
00:058F' 4C????            :                  jmp    SaveNone

                             EM_PLA:
00:0592' 68                :                  pla
00:0593' 4C????            :                  jmp    SaveAP

                             EM_PLP:
00:0596' 68                :                  pla
00:0597' 0930              :                  ora    #$30

Portable 65xx Assembler [20.01]

00:0599' 85F3              :                  sta    P_REG
00:059B' 4C????            :                  jmp    SaveNone

                             EM_PLX:
00:059E' 68                :                  pla
00:059F' 85F1              :                  sta    X_REG
00:05A1' 4C????            :                  jmp    SaveP

                             EM_PLY:
00:05A4' 68                :                  pla
00:05A5' 85F2              :                  sta    Y_REG
00:05A7' 4C????            :                  jmp    SaveP

                             ;-------------------------------------------------------------------------------

                             EM_NOP:
00:05AA' 4C????            :                  jmp    SaveNone

                             ;-------------------------------------------------------------------------------

                             EM_BRK:
00:05AD' 08                :                  php
00:05AE' 68                :                  pla
00:05AF' 0904              :                  ora    #(1<<2)         ; Set interrupt disable bit
00:05B1' 48                :                  pha
00:05B2' A5F5              :                  lda    PC_REG+1        ; Push instruction address
00:05B4' 48                :                  pha
00:05B5' A5F4              :                  lda    PC_REG+0
00:05B7' 48                :                  pha
00:05B8' ADFEFF            :                  lda    $fffe           ; Load vector address
00:05BB' 85F4              :                  sta    PC_REG+0
00:05BD' ADFFFF            :                  lda    $ffff
00:05C0' 85F5              :                  sta    PC_REG+1
00:05C2' 4C????            :                  jmp    SaveNone

                             EM_RTI:
00:05C5' 68                :                  pla
00:05C6' 85F4              :                  sta    PC_REG+0
00:05C8' 68                :                  pla
00:05C9' 85F5              :                  sta    PC_REG+1
00:05CB' 68                :                  pla
00:05CC' 0930              :                  ora    #$30
00:05CE' 85F3              :                  sta    P_REG
00:05D0' 4C????            :                  jmp    SaveNone

                             EM_RTS:
00:05D3' 68                :                  pla
00:05D4' 85F4              :                  sta    PC_REG+0
00:05D6' 68                :                  pla
00:05D7' 85F5              :                  sta    PC_REG+1
00:05D9' E6F4              :                  inc    PC_REG+0
00:05DB' D002              :                  if eq
00:05DD' E6F5              :                   inc   PC_REG+1
                                              endif

Portable 65xx Assembler [20.01]

00:05DF' 4C????            :                  jmp    SaveNone

                             EM_STP:
00:05E2' 4C????            :                  jmp    SaveNone

                             EM_WAI:
00:05E5' 4C????            :                  jmp    SaveNone

                             ;-------------------------------------------------------------------------------

                             EM_TAX:
00:05E8' A5F0              :                  lda    A_REG
00:05EA' 85F1              :                  sta    X_REG
00:05EC' 4C????            :                  jmp    SaveP

                             EM_TAY:
00:05EF' A5F0              :                  lda    A_REG
00:05F1' 85F2              :                  sta    Y_REG
00:05F3' 4C????            :                  jmp    SaveP

                             EM_TSX:
00:05F6' BA                :                  tsx
00:05F7' 86F1              :                  stx    X_REG
00:05F9' 4C????            :                  jmp    SaveP

                             EM_TXA:
00:05FC' A5F1              :                  lda    X_REG
00:05FE' 4C????            :                  jmp    SaveAP

                             EM_TXS:
00:0601' A6F1              :                  ldx    X_REG
00:0603' 9A                :                  txs
00:0604' 4C????            :                  jmp    SaveNone

                             EM_TYA:
00:0607' A5F2              :                  lda    Y_REG
00:0609' 4C????            :                  jmp    SaveAP

                             ;-------------------------------------------------------------------------------

                             EM_BBR:
00:060C' 8A                :                  txa                    ; Get bit number
00:060D' 2970              :                  and    #$70
00:060F' 4A                :                  lsr    a
00:0610' 4A                :                  lsr    a
00:0611' 4A                :                  lsr    a
00:0612' 4A                :                  lsr    a
00:0613' AA                :                  tax
00:0614' BD????            :                  lda    BITS,x          ; Map to bit mask
00:0617' 31F7              :                  and    (ADDR_S),y      ; And test value
00:0619' D06B              :                  bne    SaveNone
00:061B' 4C????            :                  jmp    EM_BRA

                             EM_BBS:

Portable 65xx Assembler [20.01]

00:061E' 8A                :                  txa                    ; Get bit number
00:061F' 2970              :                  and    #$70
00:0621' 4A                :                  lsr    a
00:0622' 4A                :                  lsr    a
00:0623' 4A                :                  lsr    a
00:0624' 4A                :                  lsr    a
00:0625' AA                :                  tax
00:0626' BD????            :                  lda    BITS,x          ; Map to bit mask
00:0629' 31F7              :                  and    (ADDR_S),y      ; And test value
00:062B' F059              :                  beq    SaveNone
00:062D' 4C????            :                  jmp    EM_BRA

                             EM_RMB:
00:0630' 8A                :                  txa                    ; Get bit number
00:0631' 2970              :                  and    #$70
00:0633' 4A                :                  lsr    a
00:0634' 4A                :                  lsr    a
00:0635' 4A                :                  lsr    a
00:0636' 4A                :                  lsr    a
00:0637' AA                :                  tax
00:0638' BD????            :                  lda    MASK,x          ; Map to bit mask
00:063B' 31F7              :                  and    (ADDR_S),y
00:063D' 91F7              :                  sta    (ADDR_S),y
00:063F' 4C????            :                  jmp    SaveNone

                             EM_SMB:
00:0642' 8A                :                  txa                    ; Get bit number
00:0643' 2970              :                  and    #$70
00:0645' 4A                :                  lsr    a
00:0646' 4A                :                  lsr    a
00:0647' 4A                :                  lsr    a
00:0648' 4A                :                  lsr    a
00:0649' AA                :                  tax
00:064A' BD????            :                  lda    BITS,x          ; Map to bit mask
00:064D' 11F7              :                  ora    (ADDR_S),y
00:064F' 91F7              :                  sta    (ADDR_S),y
00:0651' 4C????            :                  jmp    SaveNone

                             EM_TRB:
00:0654' 48                :                  pha
00:0655' 31F7              :                  and    (ADDR_S),Y
00:0657' 08                :                  php
00:0658' 68                :                  pla
00:0659' 45F3              :                  eor    P_REG
00:065B' 2902              :                  and    #1<<1
00:065D' 45F3              :                  eor    P_REG
00:065F' 85F3              :                  sta    P_REG
00:0661' 68                :                  pla
00:0662' 49FF              :                  eor    #$ff
00:0664' 31F7              :                  and    (ADDR_S),y
00:0666' 91F7              :                  sta    (ADDR_S),y
00:0668' 4C????            :                  jmp    SaveNone

                             EM_TSB:

Portable 65xx Assembler [20.01]

00:066B' 48                :                  pha
00:066C' 31F7              :                  and    (ADDR_S),Y
00:066E' 08                :                  php
00:066F' 68                :                  pla
00:0670' 45F3              :                  eor    P_REG
00:0672' 2902              :                  and    #1<<1
00:0674' 45F3              :                  eor    P_REG
00:0676' 85F3              :                  sta    P_REG
00:0678' 68                :                  pla
00:0679' 11F7              :                  ora    (ADDR_S),y
00:067B' 91F7              :                  sta    (ADDR_S),y
00:067D' 4C????            :                  jmp    SaveNone

                             ;-------------------------------------------------------------------------------

                             SaveAP:
00:0680' 85F0              :                  sta    A_REG           ; Save the updated A
                             SaveP:
00:0682' 08                :                  php                    ; Save the updated flags
00:0683' 68                :                  pla
00:0684' 85F3              :                  sta    P_REG
                             SaveNone:
00:0686' A5FB              :                  lda    TEMP+0          ; Repeat as instructed
00:0688' D002              :                  if eq
00:068A' C6FC              :                   dec   TEMP+1
                                              endif
00:068C' C6FB              :                  dec    TEMP+0

00:068E' A5FB              :                  lda    TEMP+0
00:0690' 05FC              :                  ora    TEMP+1
00:0692' F003              :                  if ne
00:0694' 4C????            :                   jmp   Trace
                                              endif

                             EM_ERR:
00:0697' 4C????            :                  jmp    NewCommand
                                             endif

                             ;===============================================================================
                             ; 'W' - Write Memory
                             ;-------------------------------------------------------------------------------

00:069A' C957              :                 cmp     #'W'
00:069C' D020              :                 if      eq
00:069E' 20????            :                  jsr    GetWord         ; Get the target address
00:06A1' B018              :                  if     cc
00:06A3' 20????            :                   jsr   SetStartAddr    ; Copy to start address
00:06A6' 20????            :                   jsr   GetByte         ; Get the value
00:06A9' B010              :                   if    cc
00:06AB' A000              :                    ldy  #0              ; Write to memory
00:06AD' A5FB              :                    lda  TEMP+0
00:06AF' 91F7              :                    sta  (ADDR_S),Y
00:06B1' A901              :                    lda  #1              ; Increment address
00:06B3' 20????            :                    jsr  BumpAddr

Portable 65xx Assembler [20.01]

00:06B6' A957              :                    lda  #'W'            ; Create prompt for next byte
00:06B8' 4C????            :                    jmp  SetPrompt
                                               endif
                                              endif
00:06BB' 4C????            :                  jmp    Error           ; Handle syntax errors
                                             endif

                             ;===============================================================================
                             ; '?' - Display Help
                             ;-------------------------------------------------------------------------------

00:06BE' C93F              :                 cmp     #'?'
00:06C0' D004              :                 if      eq
00:06C2' A231              :                  ldx    #HLP_STR
00:06C4' 8002              :                 else
00:06C6' A22D              : Error:           ldx    #ERR_STR
                                             endif
00:06C8' 20????            :                 jsr     ShowString
00:06CB' 4C????            :                 jmp     NewCommand

                             ;===============================================================================
                             ;-------------------------------------------------------------------------------

                             SetStartAddr:
00:06CE' A5FB              :                 lda     TEMP+0
00:06D0' 85F7              :                 sta     ADDR_S+0
00:06D2' A5FC              :                 lda     TEMP+1
00:06D4' 85F8              :                 sta     ADDR_S+1
00:06D6' 60                :                 rts

                             SetEndAddr:
00:06D7' A5FB              :                 lda     TEMP+0
00:06D9' 85F9              :                 sta     ADDR_E+0
00:06DB' A5FC              :                 lda     TEMP+1
00:06DD' 85FA              :                 sta     ADDR_E+1
00:06DF' 60                :                 rts

                             BumpAddr:
00:06E0' 18                :                 clc
00:06E1' 65F7              :                 adc     ADDR_S+0
00:06E3' 85F7              :                 sta     ADDR_S+0
00:06E5' A900              :                 lda     #0
00:06E7' 65F8              :                 adc     ADDR_S+1
00:06E9' 85F8              :                 sta     ADDR_S+1
00:06EB' 60                :                 rts

                             CheckEnd:
00:06EC' A5F8              :                 lda     ADDR_S+1
00:06EE' C5FA              :                 cmp     ADDR_E+1
00:06F0' 9006              :                 if      cs
00:06F2' D004              :                  if     eq
00:06F4' A5F7              :                   lda   ADDR_S+0
00:06F6' C5F9              :                   cmp   ADDR_E+0
                                              endif

Portable 65xx Assembler [20.01]

                                             endif
00:06F8' 60                :                 rts

                             ; Create a prompt string in the command buffer for the command in A using the
                             ; current value of the starting address.

                             SetPrompt:
00:06F9' A200              :                 ldx     #0              ; Clear buffer and add command letter
00:06FB' 20????            :                 jsr     AppendChar
00:06FE' A920              :                 lda     #' '            ; Then a space
00:0700' 20????            :                 jsr     AppendChar

00:0703' A5F8              :                 lda     ADDR_S+1        ; Followed by the address
00:0705' 20????            :                 jsr     AppendHex2
00:0708' A5F7              :                 lda     ADDR_S+0
00:070A' 20????            :                 jsr     AppendHex2
00:070D' A920              :                 lda     #' '            ; And another space
00:070F' 20????            :                 jsr     AppendChar
00:0712' 4C????            :                 jmp     RptCommand      ; Then output it

                             ; Convert the byte in A into hexadecimal digits and append to the command buffer.

                             AppendHex2:
00:0715' 48                :                 pha
00:0716' 4A                :                 lsr     a
00:0717' 4A                :                 lsr     a
00:0718' 4A                :                 lsr     a
00:0719' 4A                :                 lsr     a
00:071A' 20????            :                 jsr     AppendHex
00:071D' 68                :                 pla
                             AppendHex:
00:071E' 20????            :                 jsr     ToHex

                             ; Append the character in A to the command buffer to create the next prompt
                             ; string.

                             AppendChar:
00:0721' 9D0002            :                 sta     COMMAND,x
00:0724' E8                :                 inx
00:0725' 86F6              :                 stx     CMD_LEN
00:0727' 60                :                 rts

                             ;===============================================================================
                             ; Parsing Utilities
                             ;-------------------------------------------------------------------------------

                             ; Get the next characater from the command buffer indicated by the X register
                             ; and convert it to UPPER case. If the carry is set then the end of the buffer
                             ; has been reached.

                             NextChar:
00:0728' E4F6              :                 cpx     CMD_LEN         ; Reached end of buffer>
00:072A' 9003              :                 if      cs
00:072C' A900              :                  lda    #0

Portable 65xx Assembler [20.01]

00:072E' 60                :                  rts                    ; Yes, return with C=1
                                             endif
00:072F' BD0002            :                 lda     COMMAND,X       ; No, fetch a character
00:0732' E8                :                 inx

                             ; Convert the character in A to upper case.

                             ToUpper:
00:0733' C961              :                 cmp     #'a'            ; Between 'a'
00:0735' 9006              :                 if      cs
00:0737' C97B              :                  cmp    #'z'+1          ; .. and 'z'?
00:0739' B002              :                  if     cc
00:073B' 295F              :                   and   #$5f            ; Yes, convert
                                              endif
                                             endif
00:073D' 18                :                 clc                     ; Ensure C=0
00:073E' 60                :                 rts

                             ; Fetch the next characters from the command buffer ignoring spaces.

                             SkipSpaces:
                                             repeat
00:073F' 20????            :                  jsr    NextChar        ; Fetch a character?
00:0742' B005              :                  break  cs              ; Reached the end?
00:0744' C920              :                  cmp    #' '            ; A space to ignore?
00:0746' 18                :                  clc
00:0747' F0F6              :                 until   ne
00:0749' 60                :                 rts                     ; Done

                             ; Parse a word from the command buffer and store it in TEMP. Return if the
                             ; carry set if there is a syntax error.

                             GetWord:
00:074A' A004              :                 ldy     #4              ; Set maximim number of nybbles
00:074C' D002              :                 bne     GetByte+2

                             ; Parse a word from the command buffer and store it in TEMP. Return if the
                             ; carry set if there is a syntax error.

                             GetByte:
00:074E' A002              :                 ldy     #2              ; Set maximum number of nybble
00:0750' 84FD              :                 sty     COUNT

                                             .if     __65C02__|__65SC02__
00:0752' 64FB              :                 stz     TEMP+0          ; Clear conversion area
00:0754' 64FC              :                 stz     TEMP+1
                                             .else
                           -                 ldy     #0
                           -                 sty     TEMP+0          ; Clear conversion area
                           -                 sty     TEMP+1
                                             .endif

00:0756' 20????            :                 jsr     SkipSpaces      ; Fetch first character
00:0759' 20????            :                 jsr     GetNybble       ; And try to convert

Portable 65xx Assembler [20.01]

00:075C' 9001              :                 if      cs
00:075E' 60                :                  rts                    ; Syntax error
                                             endif
                                             repeat
00:075F' 06FB              :                  asl    TEMP+0          ; Fold into the result
00:0761' 26FC              :                  rol    TEMP+1
00:0763' 06FB              :                  asl    TEMP+0
00:0765' 26FC              :                  rol    TEMP+1
00:0767' 06FB              :                  asl    TEMP+0
00:0769' 26FC              :                  rol    TEMP+1
00:076B' 06FB              :                  asl    TEMP+0
00:076D' 26FC              :                  rol    TEMP+1
00:076F' 05FB              :                  ora    TEMP+0
00:0771' 85FB              :                  sta    TEMP+0

00:0773' C6FD              :                  dec    COUNT           ; Reach maximum length?
00:0775' F008              :                  break  eq

00:0777' 20????            :                  jsr    NextChar        ; Try for another nybble
00:077A' 20????            :                  jsr    GetNybble
00:077D' 90E0              :                 until   cs
00:077F' 18                :                 clc                     ; Conversion sucessfull
00:0780' 60                :                 rts

                             ; Try to parse a nybble from the command line. If not a valid hex digit then
                             ; return with the carry set.

                             GetNybble:
00:0781' 20????            :                 jsr     IsHex           ; Got a hex digit?
00:0784' 900A              :                 if      cs
00:0786' C941              :                  cmp    #'A'            ; Handle letters
00:0788' 9002              :                  if     cs
00:078A' E907              :                   sbc   #7
                                              endif
00:078C' 290F              :                  and    #$0f            ; Strip out nybble
00:078E' 18                :                  clc                    ; Done
00:078F' 60                :                  rts
                                             endif
00:0790' 38                :                 sec                     ; Set carry -- not hex
00:0791' 60                :                 rts

                             ; Return with the carry set of the character in A is a digit or 'A' thru 'F'.

                             IsHex:
00:0792' C93A              :                 cmp     #'9'+1
00:0794' B003              :                 if      cc
00:0796' C930              :                  cmp    #'0'
00:0798' 60                :                  rts
                                             endif
00:0799' C947              :                 cmp     #'F'+1
00:079B' B003              :                 if      cc
00:079D' C941              :                  cmp    #'A'
00:079F' 60                :                  rts
                                             endif

Portable 65xx Assembler [20.01]

00:07A0' 18                :                 clc
00:07A1' 60                :                 rts

                             ; Return with the carry set of the character in A is not printable.

                             IsPrintable:
00:07A2' C920              :                 cmp     #' '
00:07A4' 9006              :                 if      cs
00:07A6' C97F              :                  cmp    #DEL
00:07A8' B002              :                  if     CC
00:07AA' 38                :                   sec
00:07AB' 60                :                   rts
                                              endif
                                             endif
00:07AC' 18                :                 clc
00:07AD' 60                :                 rts

                             ;===============================================================================
                             ; Register Dump
                             ;-------------------------------------------------------------------------------

                             ; Dump all the save registers and the SP which is passed in X

                             DumpRegisters:
00:07AE' 8A                :                 txa                     ; Save SP
00:07AF' 48                :                 pha

00:07B0' A221              :                 ldx     #A_STR          ; Display A
00:07B2' 20????            :                 jsr     ShowString
00:07B5' A5F0              :                 lda     A_REG
00:07B7' 20????            :                 jsr     ShowHex2

00:07BA' A225              :                 ldx     #X_STR          ; Display X
00:07BC' 20????            :                 jsr     ShowString
00:07BF' A5F1              :                 lda     X_REG
00:07C1' 20????            :                 jsr     ShowHex2

00:07C4' A229              :                 ldx     #Y_STR          ; Display Y
00:07C6' 20????            :                 jsr     ShowString
00:07C9' A5F2              :                 lda     Y_REG
00:07CB' 20????            :                 jsr     ShowHex2

00:07CE' A21D              :                 ldx     #P_STR          ; Display P
00:07D0' 20????            :                 jsr     ShowString
00:07D3' A207              :                 ldx     #7
                                             repeat
00:07D5' A02E              :                  ldy    #'.'
00:07D7' BD????            :                  lda    BITS,x
00:07DA' 24F3              :                  bit    P_REG
00:07DC' F003              :                  if     ne
00:07DE' BC????            :                   ldy   FLAG,x
                                              endif
00:07E1' 98                :                  tya
00:07E2' 20????            :                  jsr    UartTx

Portable 65xx Assembler [20.01]

00:07E5' CA                :                  dex
00:07E6' 10ED              :                 until mi

00:07E8' A218              :                 ldx     #SP_STR         ; Display SP
00:07EA' 20????            :                 jsr     ShowString
00:07ED' 68                :                 pla
00:07EE' 4C????            :                 jmp     ShowHex2

                             ;===============================================================================
                             ; Disassembly
                             ;-------------------------------------------------------------------------------

                             Disassemble:
00:07F1' A5FB              :                 lda     TEMP+0          ; Save temporary area
00:07F3' 48                :                 pha
00:07F4' A5FC              :                 lda     TEMP+1
00:07F6' 48                :                 pha

00:07F7' 20????            :                 jsr     Space
00:07FA' A000              :                 ldy     #0              ; Fetch the opcode
00:07FC' B1F7              :                 lda     (ADDR_S),y
00:07FE' AA                :                 tax
00:07FF' 20????            :                 jsr     ShowHex2        ; .. and display it

00:0802' 20????            :                 jsr     Space
00:0805' BD????            :                 lda     MODES,x         ; Fetch the mode
00:0808' 48                :                 pha                     ; And save some copies
00:0809' 48                :                 pha
00:080A' 2943              :                 and     #MB_REL|MB_ABS  ; Show second byte if relative,
00:080C' F008              :                 if      ne              ; .. zero page, immediate or absolute
00:080E' C8                :                  iny
00:080F' B1F7              :                  lda    (ADDR_S),y
00:0811' 20????            :                  jsr    ShowHex2
00:0814' 8003              :                 else
00:0816' 20????            :                  jsr    Space2
                                             endif

00:0819' 20????            :                 jsr     Space
00:081C' 68                :                 pla                     ; Show third byte
                                             .if     __65C02__
00:081D' C961              :                 cmp     #MO_BRL         ; .. if bit relative
00:081F' F006              :                 beq     .Skip
                                             .endif
00:0821' 2903              :                 and     #MB_ABS         ; .. or absolute
00:0823' C903              :                 cmp     #MB_ABS
00:0825' D008              :                 if      eq
00:0827' C8                : .Skip:           iny
00:0828' B1F7              :                  lda    (ADDR_S),y
00:082A' 20????            :                  jsr    ShowHex2
00:082D' 8003              :                 else
00:082F' 20????            :                  jsr    Space2
                                             endif

00:0832' C8                :                 iny                     ; Save the byte count

Portable 65xx Assembler [20.01]

00:0833' 84FD              :                 sty     COUNT

00:0835' 20????            :                 jsr     Space
00:0838' A000              :                 ldy     #0              ; Fetch the opcode
00:083A' B1F7              :                 lda     (ADDR_S),y
00:083C' AA                :                 tax
00:083D' BD????            :                 lda     OPCODES,x
00:0840' AA                :                 tax
00:0841' BD????            :                 lda     MNEMONICS+1,x
00:0844' 85FB              :                 sta     TEMP
00:0846' BD????            :                 lda     MNEMONICS+0,x
00:0849' 20????            :                 jsr     ExtractLetter
00:084C' 20????            :                 jsr     ExtractLetter
00:084F' 20????            :                 jsr     ExtractLetter
00:0852' 20????            :                 jsr     Space
00:0855' A204              :                 ldx     #4

                                             .if     __65C02__
00:0857' 68                :                 pla
00:0858' 48                :                 pha
00:0859' 2920              :                 and     #MB_BIT
00:085B' F016              :                 if      ne
00:085D' A000              :                  ldy    #0
00:085F' B1F7              :                  lda    (ADDR_S),y
00:0861' 2970              :                  and    #$70
00:0863' 4A                :                  lsr    a
00:0864' 4A                :                  lsr    a
00:0865' 4A                :                  lsr    a
00:0866' 4A                :                  lsr    a
00:0867' 0930              :                  ora    #'0'
00:0869' 20????            :                  jsr    UartTx
00:086C' A92C              :                  lda    #','
00:086E' 20????            :                  jsr    UartTx
00:0871' E8                :                  inx
00:0872' E8                :                  inx
                                             endif
                                             .endif

00:0873' 68                :                 pla                     ; Indirect mode?
00:0874' 48                :                 pha
00:0875' 1006              :                 if      mi
00:0877' A928              :                  lda    #'('
00:0879' 20????            :                  jsr    UartTx
00:087C' E8                :                  inx
                                             endif

00:087D' 68                :                 pla                     ; Has an address?
00:087E' 48                :                 pha
00:087F' 2903              :                 and     #MB_ABS
00:0881' F028              :                 if      ne
00:0883' 48                :                  pha
00:0884' C902              :                  cmp    #MB_IMM         ; Immediate?
00:0886' D006              :                  if     eq
00:0888' A923              :                   lda   #'#'

Portable 65xx Assembler [20.01]

00:088A' 20????            :                   jsr   UartTx
00:088D' E8                :                   inx
                                              endif
00:088E' A924              :                  lda    #'$'
00:0890' 20????            :                  jsr    UartTx
00:0893' E8                :                  inx
00:0894' 68                :                  pla
00:0895' C903              :                  cmp    #MB_ABS         ; Absolute?
00:0897' D009              :                  if     eq
00:0899' A002              :                   ldy   #2
00:089B' B1F7              :                   lda   (ADDR_S),y      ; Show hi byte
00:089D' 20????            :                   jsr   ShowHex2
00:08A0' E8                :                   inx
00:08A1' E8                :                   inx
                                              endif
00:08A2' A001              :                  ldy    #1
00:08A4' B1F7              :                  lda    (ADDR_S),y      ; Then lo byte
00:08A6' 20????            :                  jsr    ShowHex2
00:08A9' E8                :                  inx
00:08AA' E8                :                  inx
                                             endif

                                             .if     __65C02__
00:08AB' 68                :                 pla
00:08AC' 48                :                 pha
00:08AD' 2960              :                 and     #MB_BIT|MB_REL
00:08AF' C960              :                 cmp     #MB_BIT|MB_REL
00:08B1' D006              :                 if      eq
00:08B3' A92C              :                  lda    #','
00:08B5' 20????            :                  jsr    UartTx
00:08B8' E8                :                  inx
                                             endif
                                             .endif

00:08B9' 68                :                 pla
00:08BA' 48                :                 pha
00:08BB' A8                :                 tay
00:08BC' 2940              :                 and     #MB_REL
00:08BE' F035              :                 if      ne
00:08C0' A924              :                  lda    #'$'
00:08C2' 20????            :                  jsr    UartTx
00:08C5' E8                :                  inx
00:08C6' 98                :                  tya
00:08C7' A001              :                  ldy    #1
00:08C9' 2920              :                  and    #MB_BIT
00:08CB' F001              :                  if     ne
00:08CD' C8                :                   iny
                                              endif

00:08CE' 38                :                  sec                    ; Word out address of next
00:08CF' 98                :                  tya                    ; .. instruction
00:08D0' 65F7              :                  adc    ADDR_S+0
00:08D2' 85FB              :                  sta    TEMP+0
00:08D4' A900              :                  lda    #0

Portable 65xx Assembler [20.01]

00:08D6' 65F8              :                  adc    ADDR_S+1
00:08D8' 85FC              :                  sta    TEMP+1

00:08DA' 18                :                  clc                    ; Fetch offset
00:08DB' B1F7              :                  lda    (ADDR_S),y      ; Work out lo byte
00:08DD' 65FB              :                  adc    TEMP+0
00:08DF' 48                :                  pha                    ; And save
00:08E0' B1F7              :                  lda    (ADDR_S),y
00:08E2' 2980              :                  and    #$80
00:08E4' 1002              :                  if     mi
00:08E6' A9FF              :                   lda   #$ff
                                              endif
00:08E8' 65FC              :                  adc    TEMP+1          ; Work out hi byte
00:08EA' 20????            :                  jsr    ShowHex2        ; And show result
00:08ED' E8                :                  inx
00:08EE' E8                :                  inx
00:08EF' 68                :                  pla
00:08F0' 20????            :                  jsr    ShowHex2
00:08F3' E8                :                  inx
00:08F4' E8                :                  inx
                                             endif

00:08F5' 68                :                 pla
00:08F6' 48                :                 pha
00:08F7' 2910              :                 and     #MB_ACC
00:08F9' F006              :                 if      ne
00:08FB' A941              :                  lda    #'A'
00:08FD' 20????            :                  jsr    UartTx
00:0900' E8                :                  inx
                                             endif

00:0901' 68                :                 pla
00:0902' 48                :                 pha
00:0903' 2908              :                 and     #MB_XRG
00:0905' F00C              :                 if      ne
00:0907' A92C              :                  lda    #','
00:0909' 20????            :                  jsr    UartTx
00:090C' A958              :                  lda    #'X'
00:090E' 20????            :                  jsr    UartTx
00:0911' E8                :                  inx
00:0912' E8                :                  inx
                                             endif

00:0913' 68                :                 pla
00:0914' 48                :                 pha
00:0915' 1006              :                 if      mi
00:0917' A929              :                  lda    #')'
00:0919' 20????            :                  jsr    UartTx
00:091C' E8                :                  inx
                                             endif

00:091D' 68                :                 pla
00:091E' 2904              :                 and     #MB_YRG
00:0920' F00C              :                 if      ne

Portable 65xx Assembler [20.01]

00:0922' A92C              :                  lda    #','
00:0924' 20????            :                  jsr    UartTx
00:0927' A959              :                  lda    #'Y'
00:0929' 20????            :                  jsr    UartTx
00:092C' E8                :                  inx
00:092D' E8                :                  inx
                                             endif

00:092E' 68                :                 pla                     ; Restore temporary area
00:092F' 85FC              :                 sta     TEMP+1
00:0931' 68                :                 pla
00:0932' 85FB              :                 sta     TEMP+0

00:0934' A5FD              :                 lda     COUNT           ; Return the number of bytes
00:0936' 60                :                 rts

                             ExtractLetter:
00:0937' 48                :                 pha
00:0938' 291F              :                 and     #$1f
00:093A' 0940              :                 ora     #'@'
00:093C' C95F              :                 cmp     #$5f
00:093E' D002              :                 if      eq
00:0940' A93F              :                  lda    #'?'
                                             endif
00:0942' 20????            :                 jsr     UartTx
00:0945' 68                :                 pla
00:0946' 46FB              :                 lsr     TEMP
00:0948' 6A                :                 ror     a
00:0949' 46FB              :                 lsr     TEMP
00:094B' 6A                :                 ror     a
00:094C' 46FB              :                 lsr     TEMP
00:094E' 6A                :                 ror     a
00:094F' 46FB              :                 lsr     TEMP
00:0951' 6A                :                 ror     a
00:0952' 46FB              :                 lsr     TEMP
00:0954' 6A                :                 ror     a
00:0955' 60                :                 rts

                             ;===============================================================================
                             ; Display Utilities
                             ;-------------------------------------------------------------------------------

                             ; Display the byte in A as two hexadecimal digits. The values in A & Y are
                             ; destroyed.

                             ShowHex2:
00:0956' 48                :                 pha                     ; Save a copy of the value
00:0957' 4A                :                 lsr     a               ; Shift down the hi nybble
00:0958' 4A                :                 lsr     a
00:0959' 4A                :                 lsr     a
00:095A' 4A                :                 lsr     a
00:095B' 20????            :                 jsr     ShowHex         ; Convert and display
00:095E' 68                :                 pla                     ; Pull back value and ...


Portable 65xx Assembler [20.01]

                             ; Display the lo nybble of A as a hexadecimal digit. The values in A & Y are
                             ; destroyed.

                             ShowHex:
00:095F' 20????            :                 jsr     ToHex           ; Convert to printable character
00:0962' 4C????            :                 jmp     UartTx          ; And display.

                             ; Convert the lo nybble of A to a hexadecimal digit.

00:0965' 290F              : ToHex           and     #$0f            ; Isolate the lo nybble
00:0967' F8                :                 sed                     ; Convert to ASCII using BCD
00:0968' 18                :                 clc
00:0969' 6990              :                 adc     #$90
00:096B' 6940              :                 adc     #$40
00:096D' D8                :                 cld
00:096E' 60                :                 rts                     ; Done

                             ;-------------------------------------------------------------------------------

                             ; Output two spaces.

                             Space2:
00:096F' 20????            :                 jsr     Space           ; Print one space then drop into ..

                             ; Output a single space. The values in A & Y are destroyed.

                             Space:
00:0972' A920              :                 lda     #' '
00:0974' 4C????            :                 jmp     UartTx

                             ; Output a vertical bar character.

                             Bar:
00:0977' A97C              :                 lda     #'|'
00:0979' 4C????            :                 jmp     UartTx

                             ; Output a new line

                             NewLine:
00:097C' A90D              :                 lda     #CR
00:097E' 20????            :                 jsr     UartTx
00:0981' A90A              :                 lda     #LF
00:0983' 4C????            :                 jmp     UartTx

                             ;===============================================================================
                             ; Strings
                             ;-------------------------------------------------------------------------------

                             ; Output the string in the string table starting at the offset in X until a
                             ; null byte is reached.

                             ShowString:
                                             repeat
00:0986' BD????            :                  lda    STRINGS,x       ; Fetch the next character

Portable 65xx Assembler [20.01]

00:0989' F006              :                  break  eq              ; Reached the end?
00:098B' 20????            :                  jsr    UartTx          ; No, display it
00:098E' E8                :                  inx                    ; Bump the index
00:098F' 80F5              :                 forever
00:0991' 60                :                 rts                     ; Done.

                             STRINGS:
         00000000          = TTL_STR         .equ    .-STRINGS
00:0992' 0D0A573635433032> :                 .byte   CR,LF,"W65C02SXB"
00:099D' 205B32302E31305D> :                 .byte   " [20.10]",0
         00000014          = PC_STR          .equ    .-STRINGS
00:09A6' 50433D00          :                 .byte   "PC=",0
         00000018          = SP_STR          .equ    .-STRINGS
00:09AA' 2053503D00        :                 .byte   " SP=",0
         0000001D          = P_STR           .equ    .-STRINGS
00:09AF' 20503D00          :                 .byte   " P=",0
         00000021          = A_STR           .equ    .-STRINGS
00:09B3' 20413D00          :                 .byte   " A=",0
         00000025          = X_STR           .equ    .-STRINGS
00:09B7' 20583D00          :                 .byte   " X=",0
         00000029          = Y_STR           .equ    .-STRINGS
00:09BB' 20593D00          :                 .byte   " Y=",0
         0000002D          = ERR_STR         .equ    .-STRINGS
00:09BF' 0D0A3F00          :                 .byte   CR,LF,"?",0
         00000031          = HLP_STR         .equ    .-STRINGS
00:09C3' 0D0A442078787878> :                 .byte   CR,LF,"D xxxx yyyy\t\tDisassemble"
00:09DD' 0D0A462078787878> :                 .byte   CR,LF,"F xxxx yyyy bb\t\tFill Memory"
00:09FA' 0D0A47205B787878> :                 .byte   CR,LF,"G [xxxx]\t\tGoto"
00:0A0A' 0D0A4D2078787878> :                 .byte   CR,LF,"M xxxx yyyy\t\tDisplay Memory"
00:0A27' 0D0A520909094469> :                 .byte   CR,LF,"R\t\t\tDisplay Registers"
00:0A3E' 0D0A532E2E2E0909> :                 .byte   CR,LF,"S...\t\t\tS19 Load"
00:0A4F' 0D0A54205B787878> :                 .byte   CR,LF,"T [xxxx][,cccc]\t\tTrace"
00:0A67' 0D0A572078787878> :                 .byte   CR,LF,"W xxxx yy\t\tWrite Memory"
00:0A80' 00                :                 .byte   0

00:0A81' 435A49443131564E  : FLAG            .byte   "CZID11VN"
00:0A89' 0102040810204080  : BITS            .byte   $01,$02,$04,$08,$10,$20,$40,$80
00:0A91' FEFDFBF7EFDFBF7F  : MASK            .byte   $fe,$fd,$fb,$f7,$ef,$df,$bf,$7f

                             ;===============================================================================
                             ; Instruction Lookup Tables
                             ;-------------------------------------------------------------------------------

00:0A99' 0000000000000000> :                 .align  256

                                             .if     __6502__
                           - OPCODES:
                           -                 .byte   OP_BRK,OP_ORA,OP_ERR,OP_ERR,OP_ERR,OP_ORA,OP_ASL,OP_ERR ; 0
                           -                 .byte   OP_PHP,OP_ORA,OP_ASL,OP_ERR,OP_ERR,OP_ORA,OP_ASL,OP_ERR
                           -                 .byte   OP_BPL,OP_ORA,OP_ERR,OP_ERR,OP_ERR,OP_ORA,OP_ASL,OP_ERR ; 1
                           -                 .byte   OP_CLC,OP_ORA,OP_INC,OP_ERR,OP_ERR,OP_ORA,OP_ASL,OP_ERR
                           -                 .byte   OP_JSR,OP_AND,OP_ERR,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_ERR ; 2
                           -                 .byte   OP_PLP,OP_AND,OP_ROL,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_ERR
                           -                 .byte   OP_BMI,OP_AND,OP_ERR,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_ERR ; 3

Portable 65xx Assembler [20.01]

                           -                 .byte   OP_SEC,OP_AND,OP_DEC,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_ERR
                           -                 .byte   OP_RTI,OP_EOR,OP_ERR,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_ERR ; 4
                           -                 .byte   OP_PHA,OP_EOR,OP_LSR,OP_ERR,OP_JMP,OP_EOR,OP_LSR,OP_ERR
                           -                 .byte   OP_BVC,OP_EOR,OP_ERR,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_ERR ; 5
                           -                 .byte   OP_CLI,OP_EOR,OP_ERR,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_ERR
                           -                 .byte   OP_RTS,OP_ADC,OP_ERR,OP_ERR,OP_ERR,OP_ADC,OP_ROR,OP_ERR ; 6
                           -                 .byte   OP_PLA,OP_ADC,OP_ROR,OP_ERR,OP_JMP,OP_ADC,OP_ROR,OP_ERR
                           -                 .byte   OP_BVS,OP_ADC,OP_ERR,OP_ERR,OP_ERR,OP_ADC,OP_ROR,OP_ERR ; 7
                           -                 .byte   OP_SEI,OP_ADC,OP_ERR,OP_ERR,OP_ERR,OP_ADC,OP_ROR,OP_ERR
                           -                 .byte   OP_ERR,OP_STA,OP_ERR,OP_ERR,OP_STY,OP_STA,OP_STX,OP_ERR ; 8
                           -                 .byte   OP_DEY,OP_BIT,OP_TXA,OP_ERR,OP_STY,OP_STA,OP_STX,OP_ERR
                           -                 .byte   OP_BCC,OP_STA,OP_ERR,OP_ERR,OP_STY,OP_STA,OP_STX,OP_ERR ; 9
                           -                 .byte   OP_TYA,OP_STA,OP_TXS,OP_ERR,OP_ERR,OP_STA,OP_ERR,OP_ERR
                           -                 .byte   OP_LDY,OP_LDA,OP_LDX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_ERR ; A
                           -                 .byte   OP_TAY,OP_LDA,OP_TAX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_ERR
                           -                 .byte   OP_BCS,OP_LDA,OP_ERR,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_ERR ; B
                           -                 .byte   OP_CLV,OP_LDA,OP_TSX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_ERR
                           -                 .byte   OP_CPY,OP_CMP,OP_ERR,OP_ERR,OP_CPY,OP_CMP,OP_DEC,OP_ERR ; C
                           -                 .byte   OP_INY,OP_CMP,OP_DEX,OP_ERR,OP_CPY,OP_CMP,OP_DEC,OP_ERR
                           -                 .byte   OP_BNE,OP_CMP,OP_ERR,OP_ERR,OP_ERR,OP_CMP,OP_DEC,OP_ERR ; D
                           -                 .byte   OP_CLD,OP_CMP,OP_ERR,OP_ERR,OP_ERR,OP_CMP,OP_DEC,OP_ERR
                           -                 .byte   OP_CPX,OP_SBC,OP_ERR,OP_ERR,OP_CPX,OP_SBC,OP_INC,OP_ERR ; E
                           -                 .byte   OP_INX,OP_SBC,OP_NOP,OP_ERR,OP_CPX,OP_SBC,OP_INC,OP_ERR
                           -                 .byte   OP_BEQ,OP_SBC,OP_ERR,OP_ERR,OP_ERR,OP_SBC,OP_INC,OP_ERR ; F
                           -                 .byte   OP_SED,OP_SBC,OP_ERR,OP_ERR,OP_ERR,OP_SBC,OP_INC,OP_ERR

                           - MODES:
                           -                 .byte   MO_IMM,MO_IZX,MO_IMM,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_IMP ; 0
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; 1
                           -                 .byte   MO_IMP,MO_ABY,MO_ACC,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_ABS,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; 2
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPX,MO_IMP ; 3
                           -                 .byte   MO_IMP,MO_ABY,MO_ACC,MO_IMP,MO_ABX,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMP,MO_IZX,MO_IMP,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_IMP ; 4
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; 5
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMP,MO_IZX,MO_IMP,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_IMP ; 6
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_IAB,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; 7
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMP,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; 8
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPY,MO_IMP ; 9
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_IMP,MO_IMP
                           -                 .byte   MO_IMM,MO_IZX,MO_IMM,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; A
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPY,MO_IMP ; B
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_ABY,MO_IMP
                           -                 .byte   MO_IMM,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; C
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; D

Portable 65xx Assembler [20.01]

                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMM,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; E
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IMP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; F
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                                             .endif

                             ;-------------------------------------------------------------------------------

                                             .if     __65C02__
                             OPCODES:
00:0B00' 1C4C0000824C065E  :                 .byte   OP_BRK,OP_ORA,OP_ERR,OP_ERR,OP_TSB,OP_ORA,OP_ASL,OP_RMB ; 0
00:0B08' 504C0600824C0608  :                 .byte   OP_PHP,OP_ORA,OP_ASL,OP_ERR,OP_TSB,OP_ORA,OP_ASL,OP_BBR
00:0B10' 184C4C00804C065E  :                 .byte   OP_BPL,OP_ORA,OP_ORA,OP_ERR,OP_TRB,OP_ORA,OP_ASL,OP_RMB ; 1
00:0B18' 224C3800804C0608  :                 .byte   OP_CLC,OP_ORA,OP_INC,OP_ERR,OP_TRB,OP_ORA,OP_ASL,OP_BBR
00:0B20' 400400001204605E  :                 .byte   OP_JSR,OP_AND,OP_ERR,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_RMB ; 2
00:0B28' 5804600012046008  :                 .byte   OP_PLP,OP_AND,OP_ROL,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_BBR
00:0B30' 140404001204605E  :                 .byte   OP_BMI,OP_AND,OP_AND,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_RMB ; 3
00:0B38' 6A04300012046008  :                 .byte   OP_SEC,OP_AND,OP_DEC,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_BBR
00:0B40' 643600000036485E  :                 .byte   OP_RTI,OP_EOR,OP_ERR,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_RMB ; 4
00:0B48' 4E3648003E364808  :                 .byte   OP_PHA,OP_EOR,OP_LSR,OP_ERR,OP_JMP,OP_EOR,OP_LSR,OP_BBR
00:0B50' 1E3636000036485E  :                 .byte   OP_BVC,OP_EOR,OP_EOR,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_RMB ; 5
00:0B58' 2636540000364808  :                 .byte   OP_CLI,OP_EOR,OP_PHY,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_BBR
00:0B60' 660200007A02625E  :                 .byte   OP_RTS,OP_ADC,OP_ERR,OP_ERR,OP_STZ,OP_ADC,OP_ROR,OP_RMB ; 6
00:0B68' 560262003E026208  :                 .byte   OP_PLA,OP_ADC,OP_ROR,OP_ERR,OP_JMP,OP_ADC,OP_ROR,OP_BBR
00:0B70' 200202007A02625E  :                 .byte   OP_BVS,OP_ADC,OP_ADC,OP_ERR,OP_STZ,OP_ADC,OP_ROR,OP_RMB ; 7
00:0B78' 6E025C003E026208  :                 .byte   OP_SEI,OP_ADC,OP_PLY,OP_ERR,OP_JMP,OP_ADC,OP_ROR,OP_BBR
00:0B80' 1A72000078727670  :                 .byte   OP_BRA,OP_STA,OP_ERR,OP_ERR,OP_STY,OP_STA,OP_STX,OP_SMB ; 8
00:0B88' 341286007872760A  :                 .byte   OP_DEY,OP_BIT,OP_TXA,OP_ERR,OP_STY,OP_STA,OP_STX,OP_BBS
00:0B90' 0C72720078727670  :                 .byte   OP_BCC,OP_STA,OP_STA,OP_ERR,OP_STY,OP_STA,OP_STX,OP_SMB ; 9
00:0B98' 8A7288007A727A0A  :                 .byte   OP_TYA,OP_STA,OP_TXS,OP_ERR,OP_STZ,OP_STA,OP_STZ,OP_BBS
00:0BA0' 4642440046424470  :                 .byte   OP_LDY,OP_LDA,OP_LDX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_SMB ; A
00:0BA8' 7E427C004642440A  :                 .byte   OP_TAY,OP_LDA,OP_TAX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_BBS
00:0BB0' 0E42420046424470  :                 .byte   OP_BCS,OP_LDA,OP_LDA,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_SMB ; B
00:0BB8' 284284004642440A  :                 .byte   OP_CLV,OP_LDA,OP_TSX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_BBS
00:0BC0' 2E2A00002E2A3070  :                 .byte   OP_CPY,OP_CMP,OP_ERR,OP_ERR,OP_CPY,OP_CMP,OP_DEC,OP_SMB ; C
00:0BC8' 3C2A328C2E2A300A  :                 .byte   OP_INY,OP_CMP,OP_DEX,OP_WAI,OP_CPY,OP_CMP,OP_DEC,OP_BBS
00:0BD0' 162A2A00002A3070  :                 .byte   OP_BNE,OP_CMP,OP_CMP,OP_ERR,OP_ERR,OP_CMP,OP_DEC,OP_SMB ; D
00:0BD8' 242A5274002A300A  :                 .byte   OP_CLD,OP_CMP,OP_PHX,OP_STP,OP_ERR,OP_CMP,OP_DEC,OP_BBS
00:0BE0' 2C6800002C683870  :                 .byte   OP_CPX,OP_SBC,OP_ERR,OP_ERR,OP_CPX,OP_SBC,OP_INC,OP_SMB ; E
00:0BE8' 3A684A002C68380A  :                 .byte   OP_INX,OP_SBC,OP_NOP,OP_ERR,OP_CPX,OP_SBC,OP_INC,OP_BBS
00:0BF0' 1068680000683870  :                 .byte   OP_BEQ,OP_SBC,OP_SBC,OP_ERR,OP_ERR,OP_SBC,OP_INC,OP_SMB ; F
00:0BF8' 6C685A000068380A  :                 .byte   OP_SED,OP_SBC,OP_PLX,OP_ERR,OP_ERR,OP_SBC,OP_INC,OP_BBS

                             MODES:
00:0C00' 0289020001010101  :                 .byte   MO_IMM,MO_IZX,MO_IMM,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_ZPG ; 0
00:0C08' 0002100003030361  :                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_BRL
00:0C10' 4085810001090901  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPG,MO_ZPX,MO_ZPX,MO_ZPG ; 1
00:0C18' 00071000030B0B61  :                 .byte   MO_IMP,MO_ABY,MO_ACC,MO_IMP,MO_ABS,MO_ABX,MO_ABX,MO_BRL
00:0C20' 0389000001010101  :                 .byte   MO_ABS,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_ZPG ; 2
00:0C28' 0002100003030361  :                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_BRL
00:0C30' 4085810009090901  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPX,MO_ZPG ; 3
00:0C38' 000710000B0B0B61  :                 .byte   MO_IMP,MO_ABY,MO_ACC,MO_IMP,MO_ABX,MO_ABX,MO_ABX,MO_BRL
00:0C40' 0089000000010101  :                 .byte   MO_IMP,MO_IZX,MO_IMP,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG ; 4

Portable 65xx Assembler [20.01]

00:0C48' 0002100003030361  :                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_BRL
00:0C50' 4085810000090901  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPG ; 5
00:0C58' 00070000000B0B61  :                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_BRL
00:0C60' 0089000001010101  :                 .byte   MO_IMP,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_ZPG ; 6
00:0C68' 0002100083030361  :                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_IAB,MO_ABS,MO_ABS,MO_BRL
00:0C70' 4085810009090901  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPX,MO_ZPG ; 7
00:0C78' 000700008B0B0B61  :                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IAX,MO_ABX,MO_ABX,MO_BRL
00:0C80' 4089000001010101  :                 .byte   MO_REL,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_ZPG ; 8
00:0C88' 0002000003030361  :                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_BRL
00:0C90' 4085810009090501  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPY,MO_ZPG ; 9
00:0C98' 00070000030B0B61  :                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_ABS,MO_ABX,MO_ABX,MO_BRL
00:0CA0' 0289020001010101  :                 .byte   MO_IMM,MO_IZX,MO_IMM,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_ZPG ; A
00:0CA8' 0002000003030361  :                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_BRL
00:0CB0' 4085810009090501  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPY,MO_ZPG ; B
00:0CB8' 000700000B0B0761  :                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_ABY,MO_BRL
00:0CC0' 0289000001010101  :                 .byte   MO_IMM,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_ZPG ; C
00:0CC8' 0002000003030361  :                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_BRL
00:0CD0' 4085810000090901  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPG ; D
00:0CD8' 00070000000B0B61  :                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_BRL
00:0CE0' 0289000001010101  :                 .byte   MO_IMM,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_ZPG ; E
00:0CE8' 0002000003030361  :                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_BRL
00:0CF0' 4085810000090901  :                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPG ; F
00:0CF8' 00070000000B0B61  :                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_BRL
                                             .endif

                             ;-------------------------------------------------------------------------------

                                             .if     __65SC02__
                           - OPCODES:
                           -                 .byte   OP_BRK,OP_ORA,OP_ERR,OP_ERR,OP_TSB,OP_ORA,OP_ASL,OP_NOP ; 0
                           -                 .byte   OP_PHP,OP_ORA,OP_ASL,OP_ERR,OP_TSB,OP_ORA,OP_ASL,OP_NOP
                           -                 .byte   OP_BPL,OP_ORA,OP_ORA,OP_ERR,OP_TRB,OP_ORA,OP_ASL,OP_NOP ; 1
                           -                 .byte   OP_CLC,OP_ORA,OP_INC,OP_ERR,OP_TRB,OP_ORA,OP_ASL,OP_NOP
                           -                 .byte   OP_JSR,OP_AND,OP_ERR,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_NOP ; 2
                           -                 .byte   OP_PLP,OP_AND,OP_ROL,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_NOP
                           -                 .byte   OP_BMI,OP_AND,OP_AND,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_NOP ; 3
                           -                 .byte   OP_SEC,OP_AND,OP_DEC,OP_ERR,OP_BIT,OP_AND,OP_ROL,OP_NOP
                           -                 .byte   OP_RTI,OP_EOR,OP_ERR,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_NOP ; 4
                           -                 .byte   OP_PHA,OP_EOR,OP_LSR,OP_ERR,OP_JMP,OP_EOR,OP_LSR,OP_NOP
                           -                 .byte   OP_BVC,OP_EOR,OP_EOR,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_NOP ; 5
                           -                 .byte   OP_CLI,OP_EOR,OP_PHY,OP_ERR,OP_ERR,OP_EOR,OP_LSR,OP_NOP
                           -                 .byte   OP_RTS,OP_ADC,OP_ERR,OP_ERR,OP_STZ,OP_ADC,OP_ROR,OP_NOP ; 6
                           -                 .byte   OP_PLA,OP_ADC,OP_ROR,OP_ERR,OP_JMP,OP_ADC,OP_ROR,OP_NOP
                           -                 .byte   OP_BVS,OP_ADC,OP_ADC,OP_ERR,OP_STZ,OP_ADC,OP_ROR,OP_NOP ; 7
                           -                 .byte   OP_SEI,OP_ADC,OP_PLY,OP_ERR,OP_JMP,OP_ADC,OP_ROR,OP_NOP
                           -                 .byte   OP_BRA,OP_STA,OP_ERR,OP_ERR,OP_STY,OP_STA,OP_STX,OP_NOP ; 8
                           -                 .byte   OP_DEY,OP_BIT,OP_TXA,OP_ERR,OP_STY,OP_STA,OP_STX,OP_NOP
                           -                 .byte   OP_BCC,OP_STA,OP_STA,OP_ERR,OP_STY,OP_STA,OP_STX,OP_NOP ; 9
                           -                 .byte   OP_TYA,OP_STA,OP_TXS,OP_ERR,OP_STZ,OP_STA,OP_STZ,OP_NOP
                           -                 .byte   OP_LDY,OP_LDA,OP_LDX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_NOP ; A
                           -                 .byte   OP_TAY,OP_LDA,OP_TAX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_NOP
                           -                 .byte   OP_BCS,OP_LDA,OP_LDA,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_NOP ; B
                           -                 .byte   OP_CLV,OP_LDA,OP_TSX,OP_ERR,OP_LDY,OP_LDA,OP_LDX,OP_NOP
                           -                 .byte   OP_CPY,OP_CMP,OP_ERR,OP_ERR,OP_CPY,OP_CMP,OP_DEC,OP_NOP ; C

Portable 65xx Assembler [20.01]

                           -                 .byte   OP_INY,OP_CMP,OP_DEX,OP_WAI,OP_CPY,OP_CMP,OP_DEC,OP_NOP
                           -                 .byte   OP_BNE,OP_CMP,OP_CMP,OP_ERR,OP_ERR,OP_CMP,OP_DEC,OP_NOP ; D
                           -                 .byte   OP_CLD,OP_CMP,OP_PHX,OP_STP,OP_ERR,OP_CMP,OP_DEC,OP_NOP
                           -                 .byte   OP_CPX,OP_SBC,OP_ERR,OP_ERR,OP_CPX,OP_SBC,OP_INC,OP_NOP ; E
                           -                 .byte   OP_INX,OP_SBC,OP_NOP,OP_ERR,OP_CPX,OP_SBC,OP_INC,OP_NOP
                           -                 .byte   OP_BEQ,OP_SBC,OP_SBC,OP_ERR,OP_ERR,OP_SBC,OP_INC,OP_NOP ; F
                           -                 .byte   OP_SED,OP_SBC,OP_PLX,OP_ERR,OP_ERR,OP_SBC,OP_INC,OP_NOP

                           - MODES:
                           -                 .byte   MO_IMM,MO_IZX,MO_IMM,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; 0
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPG,MO_ZPX,MO_ZPX,MO_IMP ; 1
                           -                 .byte   MO_IMP,MO_ABY,MO_ACC,MO_IMP,MO_ABS,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_ABS,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; 2
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPX,MO_IMP ; 3
                           -                 .byte   MO_IMP,MO_ABY,MO_ACC,MO_IMP,MO_ABX,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMP,MO_IZX,MO_IMP,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_IMP ; 4
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; 5
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMP,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; 6
                           -                 .byte   MO_IMP,MO_IMM,MO_ACC,MO_IMP,MO_IAB,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPX,MO_IMP ; 7
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IAX,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_REL,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; 8
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPY,MO_IMP ; 9
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_ABS,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMM,MO_IZX,MO_IMM,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; A
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_ZPX,MO_ZPX,MO_ZPY,MO_IMP ; B
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_ABY,MO_IMP
                           -                 .byte   MO_IMM,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; C
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; D
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                           -                 .byte   MO_IMM,MO_IZX,MO_IMP,MO_IMP,MO_ZPG,MO_ZPG,MO_ZPG,MO_IMP ; E
                           -                 .byte   MO_IMP,MO_IMM,MO_IMP,MO_IMP,MO_ABS,MO_ABS,MO_ABS,MO_IMP
                           -                 .byte   MO_REL,MO_IZY,MO_IZP,MO_IMP,MO_IMP,MO_ZPX,MO_ZPX,MO_IMP ; F
                           -                 .byte   MO_IMP,MO_ABY,MO_IMP,MO_IMP,MO_IMP,MO_ABX,MO_ABX,MO_IMP
                                             .endif

                             ;===============================================================================
                             ; IRQ Handler
                             ;-------------------------------------------------------------------------------

                             ; Handle interrupts.

                             IRQ:
00:0D00' 48                :                 pha                     ; Save users registers
00:0D01' DA                :                 phx

00:0D02' BA                :                 tsx                     ; Check for BRK

Portable 65xx Assembler [20.01]

00:0D03' BD0301            :                 lda     STACK+3,X
00:0D06' 2910              :                 and     #$10
00:0D08' F004              :                 if      ne
00:0D0A' 5A                :                  phy
00:0D0B' 4C????            :                  jmp    BRK             ; Enter monitor with registers on stack
                                             endif

00:0D0E' FA                :                 plx
00:0D0F' 68                :                 pla
00:0D10' 40                : NMI:            rti                     ; Done

                             ;===============================================================================
                             ; UART I/O
                             ;-------------------------------------------------------------------------------

                             ; Inserts the byte in A into the transmit buffer. If the buffer is full then
                             ; wait until some space is available. Registers are preserved.

                             UartTx:
00:0D11' 48                :                 pha
00:0D12' DA                :                 phx
00:0D13' AA                :                 tax

00:0D14' A901              :                 lda     #$01
00:0D16' 2CE07F            : TxWait:         bit     VIA2_IRB        ; Is there space for more data
00:0D19' D0FB              :                 bne     TxWait

00:0D1B' A9FF              :                 lda     #$ff            ; Make port an output
00:0D1D' 8DE37F            :                 sta     VIA2_DDRA
00:0D20' 8EE17F            :                 stx     VIA2_ORA        ; And output the character
00:0D23' A904              :                 lda     #$04            ; Strobe WR high
00:0D25' 0CE07F            :                 tsb     VIA2_ORB
00:0D28' EA                :                 nop
00:0D29' EA                :                 nop
00:0D2A' 1CE07F            :                 trb     VIA2_ORB
00:0D2D' FA                :                 plx
00:0D2E' 68                :                 pla
00:0D2F' 60                :                 rts                     ; Done

                             ; Extracts the next character from the head of the RX buffer. If the buffer is
                             ; empty then wait for some data to be placed in it by the interrupt handler.

                             UartRx:
00:0D30' DA                :                 phx                     ; Save callers X

00:0D31' A902              :                 lda     #$02            ; Wait until data in buffer
00:0D33' 2CE07F            : RxWait:         bit     VIA2_IRB
00:0D36' D0FB              :                 bne     RxWait

00:0D38' 9CE37F            :                 stz     VIA2_DDRA       ; Make port all input
00:0D3B' ADE07F            :                 lda     VIA2_IRB
00:0D3E' A908              :                 lda     #$08            ; Strobe /RD low
00:0D40' 1CE07F            :                 trb     VIA2_ORB
00:0D43' EA                :                 nop                     ; Wait for data to be available

Portable 65xx Assembler [20.01]

00:0D44' EA                :                 nop
00:0D45' EA                :                 nop
00:0D46' EA                :                 nop
00:0D47' AEE17F            :                 ldx     VIA2_IRA        ; Read it
00:0D4A' 0CE07F            :                 tsb     VIA2_ORB        ; And end the strobe
00:0D4D' 8A                :                 txa
00:0D4E' FA                :                 plx                     ; .. and callers X
00:0D4F' 60                :                 rts                     ; Done

                             ;===============================================================================
                             ; Vector Locations
                             ;-------------------------------------------------------------------------------

00:0D50' 6C707E            : DO_IRQ          jmp     (IRQV)
00:0D53' 6C727E            : DO_NMI          jmp     (NMIV)

                             ; Shadow Vector Area

                                             .org    $7efa

00:7EFA  ????              :                 .word   DO_NMI          ; NMI
00:7EFC  ????              :                 .word   RESET           ; RESET
00:7EFE  ????              :                 .word   DO_IRQ          ; IRQ/BRK

                                             .END


Portable 65xx Assembler [20.01]

Symbol Table

ACIA1                            00007F80  | ACIA_DATA                        00000000
ACIA1_CMD                        00007F82  | MB_IMP                           00000000
ACIA1_CR                         00007F83  | MO_IMP                           00000000
ACIA1_DATA                       00007F80  | OP_ERR                           00000000
ACIA1_SR                         00007F81  | PIA_DDRA                         00000000
ACIA_CMD                         00000002  | PIA_ORA                          00000000
ACIA_CMD_DTR                     00000001  | TTL_STR                          00000000
ACIA_CMD_IRD                     00000002  | VIA_IRB                          00000000
ACIA_CMD_PMC0                    00000040  | VIA_ORB                          00000000
ACIA_CMD_PMC1                    00000080  | __6501__                         00000000
ACIA_CMD_PME                     00000020  | __6502__                         00000000
ACIA_CMD_REM                     00000010  | __65816__                        00000000
ACIA_CMD_TIC0                    00000004  | __65832__                        00000000
ACIA_CMD_TIC1                    00000008  | __65SC02__                       00000000
ACIA_CR                          00000003  | ACIA_CMD_DTR                     00000001
ACIA_CR_RCS                      00000010  | ACIA_CR_SBR0                     00000001
ACIA_CR_SBN                      00000080  | ACIA_SR                          00000001
ACIA_CR_SBR0                     00000001  | ACIA_SR_PE                       00000001
ACIA_CR_SBR1                     00000002  | C                                00000001
ACIA_CR_SBR2                     00000004  | MB_ZPG                           00000001
ACIA_CR_SBR3                     00000008  | MO_ZPG                           00000001
ACIA_CR_WL0                      00000020  | PIA_CRA                          00000001
ACIA_CR_WL1                      00000040  | PIA_CRA_CA10                     00000001
ACIA_DATA                        00000000  | PIA_CRB_CB10                     00000001
ACIA_SR                          00000001  | SOH                              00000001
ACIA_SR_DCDB                     00000020  | VIA_ACR_PB                       00000001
ACIA_SR_DSRB                     00000040  | VIA_IER_CA2                      00000001
ACIA_SR_FE                       00000002  | VIA_IFR_CA2                      00000001
ACIA_SR_IRQ                      00000080  | VIA_IRA                          00000001
ACIA_SR_OVRN                     00000004  | VIA_ORA                          00000001
ACIA_SR_PE                       00000001  | VIA_PCR_CA1C                     00000001
ACIA_SR_RDRF                     00000008  | __65C02__                        00000001
ACIA_SR_TDRE                     00000010  | ACIA_CMD                         00000002
ACK                              00000006  | ACIA_CMD_IRD                     00000002
ADDR_E                           000000F9  | ACIA_CR_SBR1                     00000002
ADDR_S                           000000F7  | ACIA_SR_FE                       00000002
A_REG                            000000F0  | MB_IMM                           00000002
A_STR                            00000021  | MO_IMM                           00000002
AppendChar                       00000721' | OP_ADC                           00000002
AppendHex                        0000071E' | PIA_CRA_CA11                     00000002
AppendHex2                       00000715' | PIA_CRB_CB11                     00000002
B                                00000010  | PIA_DDRB                         00000002
BEL                              00000007  | PIA_ORB                          00000002
BITS                             00000A89' | VIA_ACR_PA                       00000002
BRK                              000000B4' | VIA_DDRB                         00000002
BS                               00000008  | VIA_IER_CA1                      00000002
Bar                              00000977' | VIA_IFR_CA1                      00000002
BumpAddr                         000006E0' | VIA_PCR_CA2C0                    00000002
C                                00000001  | Z                                00000002
CAN                              00000018  | ACIA_CR                          00000003
CMD_LEN                          000000F6  | MB_ABS                           00000003
CMD_SIZE                         00000080  | MNEMONICS                        00000003'

Portable 65xx Assembler [20.01]

COMMAND                          00000200  | MO_ABS                           00000003
COUNT                            000000FD  | PIA_CRB                          00000003
CR                               0000000D  | VIA_DDRA                         00000003
CheckEnd                         000006EC' | ACIA_CMD_TIC0                    00000004
D                                00000008  | ACIA_CR_SBR2                     00000004
DC1                              00000011  | ACIA_SR_OVRN                     00000004
DC3                              00000013  | EOT                              00000004
DEL                              0000007F  | I                                00000004
DO_IRQ                           00000D50' | MB_YRG                           00000004
DO_NMI                           00000D53' | OP_AND                           00000004
Disassemble                      000007F1' | PIA_CRA_DDRA                     00000004
Disassemble.Skip                 00000827' | PIA_CRB_DDRB                     00000004
DumpRegisters                    000007AE' | VIA_ACR_SRC0                     00000004
EMULATE                          000003D5' | VIA_IER_SR                       00000004
EM_ADC                           0000047F' | VIA_IFR_SR                       00000004
EM_AND                           00000493' | VIA_PCR_CA2C1                    00000004
EM_ASL                           000004C1' | VIA_T1CL                         00000004
EM_BBR                           0000060C' | MO_ZPY                           00000005
EM_BBS                           0000061E' | VIA_T1CH                         00000005
EM_BCC                           00000509' | ACK                              00000006
EM_BCS                           0000050E' | OP_ASL                           00000006
EM_BEQ                           00000513' | VIA_T1LL                         00000006
EM_BIT                           000004A2' | BEL                              00000007
EM_BMI                           00000518' | MO_ABY                           00000007
EM_BNE                           0000051D' | VIA_T1LH                         00000007
EM_BPL                           00000522' | ACIA_CMD_TIC1                    00000008
EM_BRA                           00000527' | ACIA_CR_SBR3                     00000008
EM_BRK                           000005AD' | ACIA_SR_RDRF                     00000008
EM_BVC                           00000532' | BS                               00000008
EM_BVS                           00000537' | D                                00000008
EM_CLC                           00000463' | MB_XRG                           00000008
EM_CLD                           00000467' | OP_BBR                           00000008
EM_CLI                           0000046B' | PIA_CRA_CA20                     00000008
EM_CLV                           0000046F' | PIA_CRB_CB20                     00000008
EM_CMP                           0000048E' | VIA_ACR_SRC1                     00000008
EM_CPX                           00000489' | VIA_IER_CB2                      00000008
EM_CPY                           0000048C' | VIA_IFR_CB2                      00000008
EM_DEC                           000004E1' | VIA_PCR_CA2C2                    00000008
EM_DEX                           000004EB' | VIA_T2CL                         00000008
EM_DEY                           000004F0' | MO_ZPX                           00000009
EM_EOR                           00000498' | VIA_T2CH                         00000009
EM_ERR                           00000697' | LF                               0000000A
EM_INC                           000004F5' | OP_BBS                           0000000A
EM_INX                           000004FF' | VIA_SR                           0000000A
EM_INY                           00000504' | MO_ABX                           0000000B
EM_JMP                           0000054A' | VIA_ACR                          0000000B
EM_JSR                           0000053C' | OP_BCC                           0000000C
EM_LDA                           00000555' | VIA_PCR                          0000000C
EM_LDX                           0000055A' | CR                               0000000D
EM_LDY                           00000561' | VIA_IFR                          0000000D
EM_LSR                           000004C9' | OP_BCS                           0000000E
EM_NOP                           000005AA' | VIA_IER                          0000000E
EM_ORA                           0000049D' | VIA_IRAN                         0000000F
EM_PHA                           0000057C' | VIA_ORAN                         0000000F

Portable 65xx Assembler [20.01]

EM_PHP                           00000580' | ACIA_CMD_REM                     00000010
EM_PHX                           00000586' | ACIA_CR_RCS                      00000010
EM_PHY                           0000058C' | ACIA_SR_TDRE                     00000010
EM_PLA                           00000592' | B                                00000010
EM_PLP                           00000596' | MB_ACC                           00000010
EM_PLX                           0000059E' | MO_ACC                           00000010
EM_PLY                           000005A4' | OP_BEQ                           00000010
EM_RMB                           00000630' | PIA_CRA_CA21                     00000010
EM_ROL                           000004D1' | PIA_CRB_CB21                     00000010
EM_ROR                           000004D9' | VIA_ACR_SRC2                     00000010
EM_RTI                           000005C5' | VIA_IER_CB1                      00000010
EM_RTS                           000005D3' | VIA_IFR_CB1                      00000010
EM_SBC                           00000484' | VIA_PCR_CB1C                     00000010
EM_SEC                           00000473' | DC1                              00000011
EM_SED                           00000477' | OP_BIT                           00000012
EM_SEI                           0000047B' | DC3                              00000013
EM_SMB                           00000642' | OP_BMI                           00000014
EM_STA                           00000568' | PC_STR                           00000014
EM_STP                           000005E2' | NAK                              00000015
EM_STX                           0000056D' | OP_BNE                           00000016
EM_STY                           00000572' | CAN                              00000018
EM_STZ                           00000577' | OP_BPL                           00000018
EM_TAX                           000005E8' | SP_STR                           00000018
EM_TAY                           000005EF' | OP_BRA                           0000001A
EM_TRB                           00000654' | ESC                              0000001B
EM_TSB                           0000066B' | OP_BRK                           0000001C
EM_TSX                           000005F6' | P_STR                            0000001D
EM_TXA                           000005FC' | OP_BVC                           0000001E
EM_TXS                           00000601' | ACIA_CMD_PME                     00000020
EM_TYA                           00000607' | ACIA_CR_WL0                      00000020
EM_WAI                           000005E5' | ACIA_SR_DCDB                     00000020
EOT                              00000004  | MB_BIT                           00000020
ERR_STR                          0000002D  | OP_BVS                           00000020
ESC                              0000001B  | PIA_CRA_CA22                     00000020
Error                            000006C6' | PIA_CRB_CB22                     00000020
ExtractLetter                    00000937' | VIA_ACR_T2C                      00000020
FLAG                             00000A81' | VIA_IER_T2                       00000020
FOSC                             007A1200  | VIA_IFR_T2                       00000020
GetByte                          0000074E' | VIA_PCR_CB2C0                    00000020
GetNybble                        00000781' | A_STR                            00000021
GetWord                          0000074A' | MO_BIT                           00000021
HLP_STR                          00000031  | OP_CLC                           00000022
I                                00000004  | OP_CLD                           00000024
IRQ                              00000D00' | X_STR                            00000025
IRQV                             00007E70  | OP_CLI                           00000026
IsHex                            00000792' | OP_CLV                           00000028
IsPrintable                      000007A2' | Y_STR                            00000029
LF                               0000000A  | OP_CMP                           0000002A
MASK                             00000A91' | OP_CPX                           0000002C
MB_ABS                           00000003  | ERR_STR                          0000002D
MB_ACC                           00000010  | OP_CPY                           0000002E
MB_BIT                           00000020  | OP_DEC                           00000030
MB_IMM                           00000002  | HLP_STR                          00000031
MB_IMP                           00000000  | OP_DEX                           00000032

Portable 65xx Assembler [20.01]

MB_IND                           00000080  | OP_DEY                           00000034
MB_REL                           00000040  | OP_EOR                           00000036
MB_XRG                           00000008  | OP_INC                           00000038
MB_YRG                           00000004  | OP_INX                           0000003A
MB_ZPG                           00000001  | OP_INY                           0000003C
MNEMONICS                        00000003' | OP_JMP                           0000003E
MODES                            00000C00' | ACIA_CMD_PMC0                    00000040
MO_ABS                           00000003  | ACIA_CR_WL1                      00000040
MO_ABX                           0000000B  | ACIA_SR_DSRB                     00000040
MO_ABY                           00000007  | MB_REL                           00000040
MO_ACC                           00000010  | MO_REL                           00000040
MO_BIT                           00000021  | OP_JSR                           00000040
MO_BRL                           00000061  | PIA_CRA_IRQA2                    00000040
MO_IAB                           00000083  | PIA_CRB_IRQB2                    00000040
MO_IAX                           0000008B  | V                                00000040
MO_IMM                           00000002  | VIA_ACR_T1C0                     00000040
MO_IMP                           00000000  | VIA_IER_T1                       00000040
MO_IZP                           00000081  | VIA_IFR_T1                       00000040
MO_IZX                           00000089  | VIA_PCR_CB2C1                    00000040
MO_IZY                           00000085  | OP_LDA                           00000042
MO_REL                           00000040  | OP_LDX                           00000044
MO_ZPG                           00000001  | OP_LDY                           00000046
MO_ZPX                           00000009  | OP_LSR                           00000048
MO_ZPY                           00000005  | OP_NOP                           0000004A
N                                00000080  | OP_ORA                           0000004C
NAK                              00000015  | OP_PHA                           0000004E
NMI                              00000D10' | OP_PHP                           00000050
NMIV                             00007E72  | OP_PHX                           00000052
NewCommand                       000000E1' | OP_PHY                           00000054
NewLine                          0000097C' | OP_PLA                           00000056
NextChar                         00000728' | OP_PLP                           00000058
OPCODES                          00000B00' | OP_PLX                           0000005A
OP_ADC                           00000002  | OP_PLY                           0000005C
OP_AND                           00000004  | OP_RMB                           0000005E
OP_ASL                           00000006  | OP_ROL                           00000060
OP_BBR                           00000008  | MO_BRL                           00000061
OP_BBS                           0000000A  | OP_ROR                           00000062
OP_BCC                           0000000C  | OP_RTI                           00000064
OP_BCS                           0000000E  | OP_RTS                           00000066
OP_BEQ                           00000010  | OP_SBC                           00000068
OP_BIT                           00000012  | OP_SEC                           0000006A
OP_BMI                           00000014  | OP_SED                           0000006C
OP_BNE                           00000016  | OP_SEI                           0000006E
OP_BPL                           00000018  | OP_SMB                           00000070
OP_BRA                           0000001A  | OP_STA                           00000072
OP_BRK                           0000001C  | OP_STP                           00000074
OP_BVC                           0000001E  | OP_STX                           00000076
OP_BVS                           00000020  | OP_STY                           00000078
OP_CLC                           00000022  | OP_STZ                           0000007A
OP_CLD                           00000024  | OP_TAX                           0000007C
OP_CLI                           00000026  | OP_TAY                           0000007E
OP_CLV                           00000028  | DEL                              0000007F
OP_CMP                           0000002A  | ACIA_CMD_PMC1                    00000080
OP_CPX                           0000002C  | ACIA_CR_SBN                      00000080

Portable 65xx Assembler [20.01]

OP_CPY                           0000002E  | ACIA_SR_IRQ                      00000080
OP_DEC                           00000030  | CMD_SIZE                         00000080
OP_DEX                           00000032  | MB_IND                           00000080
OP_DEY                           00000034  | N                                00000080
OP_EOR                           00000036  | OP_TRB                           00000080
OP_ERR                           00000000  | PIA_CRA_IRQA1                    00000080
OP_INC                           00000038  | PIA_CRB_IRQB1                    00000080
OP_INX                           0000003A  | VIA_ACR_T1C1                     00000080
OP_INY                           0000003C  | VIA_IER_SET                      00000080
OP_JMP                           0000003E  | VIA_IFR_IRQ                      00000080
OP_JSR                           00000040  | VIA_PCR_CB2C2                    00000080
OP_LDA                           00000042  | MO_IZP                           00000081
OP_LDX                           00000044  | OP_TSB                           00000082
OP_LDY                           00000046  | MO_IAB                           00000083
OP_LSR                           00000048  | OP_TSX                           00000084
OP_NOP                           0000004A  | MO_IZY                           00000085
OP_ORA                           0000004C  | OP_TXA                           00000086
OP_PHA                           0000004E  | OP_TXS                           00000088
OP_PHP                           00000050  | MO_IZX                           00000089
OP_PHX                           00000052  | OP_TYA                           0000008A
OP_PHY                           00000054  | MO_IAX                           0000008B
OP_PLA                           00000056  | OP_WAI                           0000008C
OP_PLP                           00000058  | RESET                            00000091'
OP_PLX                           0000005A  | VECTORS                          000000B0'
OP_PLY                           0000005C  | BRK                              000000B4'
OP_RMB                           0000005E  | ShowRegisters                    000000CB'
OP_ROL                           00000060  | NewCommand                       000000E1'
OP_ROR                           00000062  | RptCommand                       000000E3'
OP_RTI                           00000064  | A_REG                            000000F0
OP_RTS                           00000066  | X_REG                            000000F1
OP_SBC                           00000068  | Y_REG                            000000F2
OP_SEC                           0000006A  | P_REG                            000000F3
OP_SED                           0000006C  | PC_REG                           000000F4
OP_SEI                           0000006E  | CMD_LEN                          000000F6
OP_SMB                           00000070  | ADDR_S                           000000F7
OP_STA                           00000072  | ADDR_E                           000000F9
OP_STP                           00000074  | TEMP                             000000FB
OP_STX                           00000076  | COUNT                            000000FD
OP_STY                           00000078  | STACK                            00000100
OP_STZ                           0000007A  | RptCommand.FillFail              000001BA'
OP_TAX                           0000007C  | COMMAND                          00000200
OP_TAY                           0000007E  | RptCommand.S19Fail               000002A0'
OP_TRB                           00000080  | Trace                            000002CB'
OP_TSB                           00000082  | EMULATE                          000003D5'
OP_TSX                           00000084  | EM_CLC                           00000463'
OP_TXA                           00000086  | EM_CLD                           00000467'
OP_TXS                           00000088  | EM_CLI                           0000046B'
OP_TYA                           0000008A  | EM_CLV                           0000046F'
OP_WAI                           0000008C  | EM_SEC                           00000473'
PC_REG                           000000F4  | EM_SED                           00000477'
PC_STR                           00000014  | EM_SEI                           0000047B'
PIA1                             00007FA0  | EM_ADC                           0000047F'
PIA1_CRA                         00007FA1  | EM_SBC                           00000484'
PIA1_CRB                         00007FA3  | EM_CPX                           00000489'

Portable 65xx Assembler [20.01]

PIA1_DDRA                        00007FA0  | EM_CPY                           0000048C'
PIA1_DDRB                        00007FA2  | EM_CMP                           0000048E'
PIA1_ORA                         00007FA0  | EM_AND                           00000493'
PIA1_ORB                         00007FA2  | EM_EOR                           00000498'
PIA_CRA                          00000001  | EM_ORA                           0000049D'
PIA_CRA_CA10                     00000001  | EM_BIT                           000004A2'
PIA_CRA_CA11                     00000002  | EM_ASL                           000004C1'
PIA_CRA_CA20                     00000008  | EM_LSR                           000004C9'
PIA_CRA_CA21                     00000010  | EM_ROL                           000004D1'
PIA_CRA_CA22                     00000020  | EM_ROR                           000004D9'
PIA_CRA_DDRA                     00000004  | EM_DEC                           000004E1'
PIA_CRA_IRQA1                    00000080  | EM_DEX                           000004EB'
PIA_CRA_IRQA2                    00000040  | EM_DEY                           000004F0'
PIA_CRB                          00000003  | EM_INC                           000004F5'
PIA_CRB_CB10                     00000001  | EM_INX                           000004FF'
PIA_CRB_CB11                     00000002  | EM_INY                           00000504'
PIA_CRB_CB20                     00000008  | EM_BCC                           00000509'
PIA_CRB_CB21                     00000010  | EM_BCS                           0000050E'
PIA_CRB_CB22                     00000020  | EM_BEQ                           00000513'
PIA_CRB_DDRB                     00000004  | EM_BMI                           00000518'
PIA_CRB_IRQB1                    00000080  | EM_BNE                           0000051D'
PIA_CRB_IRQB2                    00000040  | EM_BPL                           00000522'
PIA_DDRA                         00000000  | EM_BRA                           00000527'
PIA_DDRB                         00000002  | EM_BVC                           00000532'
PIA_ORA                          00000000  | EM_BVS                           00000537'
PIA_ORB                          00000002  | EM_JSR                           0000053C'
P_REG                            000000F3  | EM_JMP                           0000054A'
P_STR                            0000001D  | EM_LDA                           00000555'
RESET                            00000091' | EM_LDX                           0000055A'
RptCommand                       000000E3' | EM_LDY                           00000561'
RptCommand.FillFail              000001BA' | EM_STA                           00000568'
RptCommand.S19Fail               000002A0' | EM_STX                           0000056D'
RxWait                           00000D33' | EM_STY                           00000572'
SOH                              00000001  | EM_STZ                           00000577'
SP_STR                           00000018  | EM_PHA                           0000057C'
STACK                            00000100  | EM_PHP                           00000580'
STRINGS                          00000992' | EM_PHX                           00000586'
SaveAP                           00000680' | EM_PHY                           0000058C'
SaveNone                         00000686' | EM_PLA                           00000592'
SaveP                            00000682' | EM_PLP                           00000596'
SetEndAddr                       000006D7' | EM_PLX                           0000059E'
SetPrompt                        000006F9' | EM_PLY                           000005A4'
SetStartAddr                     000006CE' | EM_NOP                           000005AA'
ShowHex                          0000095F' | EM_BRK                           000005AD'
ShowHex2                         00000956' | EM_RTI                           000005C5'
ShowRegisters                    000000CB' | EM_RTS                           000005D3'
ShowString                       00000986' | EM_STP                           000005E2'
SkipSpaces                       0000073F' | EM_WAI                           000005E5'
Space                            00000972' | EM_TAX                           000005E8'
Space2                           0000096F' | EM_TAY                           000005EF'
TEMP                             000000FB  | EM_TSX                           000005F6'
TTL_STR                          00000000  | EM_TXA                           000005FC'
ToHex                            00000965' | EM_TXS                           00000601'
ToUpper                          00000733' | EM_TYA                           00000607'

Portable 65xx Assembler [20.01]

Trace                            000002CB' | EM_BBR                           0000060C'
TxWait                           00000D16' | EM_BBS                           0000061E'
UartRx                           00000D30' | EM_RMB                           00000630'
UartTx                           00000D11' | EM_SMB                           00000642'
V                                00000040  | EM_TRB                           00000654'
VECTORS                          000000B0' | EM_TSB                           0000066B'
VIA1                             00007FC0  | SaveAP                           00000680'
VIA1_ACR                         00007FCB  | SaveP                            00000682'
VIA1_DDRA                        00007FC3  | SaveNone                         00000686'
VIA1_DDRB                        00007FC2  | EM_ERR                           00000697'
VIA1_IER                         00007FCE  | Error                            000006C6'
VIA1_IFR                         00007FCD  | SetStartAddr                     000006CE'
VIA1_IRA                         00007FC1  | SetEndAddr                       000006D7'
VIA1_IRAN                        00007FCF  | BumpAddr                         000006E0'
VIA1_IRB                         00007FC0  | CheckEnd                         000006EC'
VIA1_ORA                         00007FC1  | SetPrompt                        000006F9'
VIA1_ORAN                        00007FCF  | AppendHex2                       00000715'
VIA1_ORB                         00007FC0  | AppendHex                        0000071E'
VIA1_PCR                         00007FCC  | AppendChar                       00000721'
VIA1_SR                          00007FCA  | NextChar                         00000728'
VIA1_T1CH                        00007FC5  | ToUpper                          00000733'
VIA1_T1CL                        00007FC4  | SkipSpaces                       0000073F'
VIA1_T1LH                        00007FC7  | GetWord                          0000074A'
VIA1_T1LL                        00007FC6  | GetByte                          0000074E'
VIA1_T2CH                        00007FC9  | GetNybble                        00000781'
VIA1_T2CL                        00007FC8  | IsHex                            00000792'
VIA2                             00007FE0  | IsPrintable                      000007A2'
VIA2_ACR                         00007FEB  | DumpRegisters                    000007AE'
VIA2_DDRA                        00007FE3  | Disassemble                      000007F1'
VIA2_DDRB                        00007FE2  | Disassemble.Skip                 00000827'
VIA2_IER                         00007FEE  | ExtractLetter                    00000937'
VIA2_IFR                         00007FED  | ShowHex2                         00000956'
VIA2_IRA                         00007FE1  | ShowHex                          0000095F'
VIA2_IRAN                        00007FEF  | ToHex                            00000965'
VIA2_IRB                         00007FE0  | Space2                           0000096F'
VIA2_ORA                         00007FE1  | Space                            00000972'
VIA2_ORAN                        00007FEF  | Bar                              00000977'
VIA2_ORB                         00007FE0  | NewLine                          0000097C'
VIA2_PCR                         00007FEC  | ShowString                       00000986'
VIA2_SR                          00007FEA  | STRINGS                          00000992'
VIA2_T1CH                        00007FE5  | FLAG                             00000A81'
VIA2_T1CL                        00007FE4  | BITS                             00000A89'
VIA2_T1LH                        00007FE7  | MASK                             00000A91'
VIA2_T1LL                        00007FE6  | OPCODES                          00000B00'
VIA2_T2CH                        00007FE9  | MODES                            00000C00'
VIA2_T2CL                        00007FE8  | IRQ                              00000D00'
VIA_ACR                          0000000B  | NMI                              00000D10'
VIA_ACR_PA                       00000002  | UartTx                           00000D11'
VIA_ACR_PB                       00000001  | TxWait                           00000D16'
VIA_ACR_SRC0                     00000004  | UartRx                           00000D30'
VIA_ACR_SRC1                     00000008  | RxWait                           00000D33'
VIA_ACR_SRC2                     00000010  | DO_IRQ                           00000D50'
VIA_ACR_T1C0                     00000040  | DO_NMI                           00000D53'
VIA_ACR_T1C1                     00000080  | IRQV                             00007E70

Portable 65xx Assembler [20.01]

VIA_ACR_T2C                      00000020  | NMIV                             00007E72
VIA_DDRA                         00000003  | ACIA1                            00007F80
VIA_DDRB                         00000002  | ACIA1_DATA                       00007F80
VIA_IER                          0000000E  | ACIA1_SR                         00007F81
VIA_IER_CA1                      00000002  | ACIA1_CMD                        00007F82
VIA_IER_CA2                      00000001  | ACIA1_CR                         00007F83
VIA_IER_CB1                      00000010  | PIA1                             00007FA0
VIA_IER_CB2                      00000008  | PIA1_DDRA                        00007FA0
VIA_IER_SET                      00000080  | PIA1_ORA                         00007FA0
VIA_IER_SR                       00000004  | PIA1_CRA                         00007FA1
VIA_IER_T1                       00000040  | PIA1_DDRB                        00007FA2
VIA_IER_T2                       00000020  | PIA1_ORB                         00007FA2
VIA_IFR                          0000000D  | PIA1_CRB                         00007FA3
VIA_IFR_CA1                      00000002  | VIA1                             00007FC0
VIA_IFR_CA2                      00000001  | VIA1_IRB                         00007FC0
VIA_IFR_CB1                      00000010  | VIA1_ORB                         00007FC0
VIA_IFR_CB2                      00000008  | VIA1_IRA                         00007FC1
VIA_IFR_IRQ                      00000080  | VIA1_ORA                         00007FC1
VIA_IFR_SR                       00000004  | VIA1_DDRB                        00007FC2
VIA_IFR_T1                       00000040  | VIA1_DDRA                        00007FC3
VIA_IFR_T2                       00000020  | VIA1_T1CL                        00007FC4
VIA_IRA                          00000001  | VIA1_T1CH                        00007FC5
VIA_IRAN                         0000000F  | VIA1_T1LL                        00007FC6
VIA_IRB                          00000000  | VIA1_T1LH                        00007FC7
VIA_ORA                          00000001  | VIA1_T2CL                        00007FC8
VIA_ORAN                         0000000F  | VIA1_T2CH                        00007FC9
VIA_ORB                          00000000  | VIA1_SR                          00007FCA
VIA_PCR                          0000000C  | VIA1_ACR                         00007FCB
VIA_PCR_CA1C                     00000001  | VIA1_PCR                         00007FCC
VIA_PCR_CA2C0                    00000002  | VIA1_IFR                         00007FCD
VIA_PCR_CA2C1                    00000004  | VIA1_IER                         00007FCE
VIA_PCR_CA2C2                    00000008  | VIA1_IRAN                        00007FCF
VIA_PCR_CB1C                     00000010  | VIA1_ORAN                        00007FCF
VIA_PCR_CB2C0                    00000020  | VIA2                             00007FE0
VIA_PCR_CB2C1                    00000040  | VIA2_IRB                         00007FE0
VIA_PCR_CB2C2                    00000080  | VIA2_ORB                         00007FE0
VIA_SR                           0000000A  | VIA2_IRA                         00007FE1
VIA_T1CH                         00000005  | VIA2_ORA                         00007FE1
VIA_T1CL                         00000004  | VIA2_DDRB                        00007FE2
VIA_T1LH                         00000007  | VIA2_DDRA                        00007FE3
VIA_T1LL                         00000006  | VIA2_T1CL                        00007FE4
VIA_T2CH                         00000009  | VIA2_T1CH                        00007FE5
VIA_T2CL                         00000008  | VIA2_T1LL                        00007FE6
X_REG                            000000F1  | VIA2_T1LH                        00007FE7
X_STR                            00000025  | VIA2_T2CL                        00007FE8
Y_REG                            000000F2  | VIA2_T2CH                        00007FE9
Y_STR                            00000029  | VIA2_SR                          00007FEA
Z                                00000002  | VIA2_ACR                         00007FEB
__6501__                         00000000  | VIA2_PCR                         00007FEC
__6502__                         00000000  | VIA2_IFR                         00007FED
__65816__                        00000000  | VIA2_IER                         00007FEE
__65832__                        00000000  | VIA2_IRAN                        00007FEF
__65C02__                        00000001  | VIA2_ORAN                        00007FEF
__65SC02__                       00000000  | FOSC                             007A1200
